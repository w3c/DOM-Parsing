<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta charset="UTF-8">
<meta name="generator" content="ReSpec 34.5.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
pre.idl{padding:1em;position:relative}
pre.idl>code{color:#000;color:var(--text,#000)}
@media print{
pre.idl{white-space:pre-wrap}
}
.idlHeader{display:block;width:150px;background:#8ccbf2;background:var(--def-border,#8ccbf2);color:#fff;color:var(--defrow-border,#fff);font-family:sans-serif;font-weight:700;margin:-1em 0 1em -1em;height:28px;line-height:28px}
.idlHeader a.self-link{margin-left:.3cm;text-decoration:none;border-bottom:none;color:inherit}
.idlID{font-weight:700;color:#005a9c}
.idlType{color:#005a9c}
.idlName{color:#ff4500}
.idlName a{color:#ff4500;border-bottom:1px dotted #ff4500;text-decoration:none}
a.idlEnumItem{color:#000;border-bottom:1px dotted #ccc;text-decoration:none}
.idlSuperclass{font-style:italic;color:#005a9c}
.idlDefaultValue,.idlParamName{font-style:italic}
.extAttr{color:#666}
.idlSectionComment{color:gray}
.idlIncludes a{font-weight:700}
.respec-button-copy-paste:focus{text-decoration:none;border-color:#51a7e8;outline:0;box-shadow:0 0 5px rgba(81,167,232,.5)}
.respec-button-copy-paste:is(:focus:hover,.selected:focus){border-color:#51a7e8}
.respec-button-copy-paste:is(:hover,:active,.zeroclipboard-is-hover,.zeroclipboard-is-active){text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
.respec-button-copy-paste:is(:active,.selected,.zeroclipboard-is-active){background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
.respec-button-copy-paste.selected:hover{background-color:#cfcfcf}
.respec-button-copy-paste:is(:disabled,:disabled:hover,.disabled,.disabled:hover){color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
@media print{
.respec-button-copy-paste{visibility:hidden}
}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>

<title>DOM Parsing and Serialization</title>

<style>

/* Switch statement */
dl.switch dt::before {
    content: "↪ ";
    margin-left: 1em;
}
/* Better spacing around various lists (implied paragraph children) */
ol > li, section:not(#toc) ul > li, section dl > dt {
    margin: 1em 0;
}
var { color: maroon; }
/* domintro styling */
dl.domintro {
    background-color: rgb(221, 255, 221);
    padding: 1em 0.5em 1em 2em;
    clear: both;
}
dl.domintro dt {
    color: black;
}
dl.domintro > dd {
    color: green;
}
dl.domintro::before {
    float: right;
    background-color: white;
    display: block;
    border: 2px solid black;
    color: green;
    margin-top: -20px;
    padding: 2px;
    content: "This box is non-normative. Implementation requirements are given below this box.";
}

</style>



<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "subtitle": "DOMParser, XMLSerializer, innerHTML, and similar APIs",
  "specStatus": "ED",
  "editors": [
    {
      "name": "Travis Leithead",
      "company": "Microsoft",
      "mailto": "travis.leithead@microsoft.com",
      "companyURL": "http://www.microsoft.com",
      "w3cid": "40117",
      "url": "mailto:travis.leithead@microsoft.com"
    }
  ],
  "edDraftURI": "https://w3c.github.io/DOM-Parsing/",
  "xref": [
    "webidl",
    "html"
  ],
  "shortName": "DOM-Parsing",
  "wg": [
    "Web Platform Working Group"
  ],
  "group": "wg/webapps",
  "wgURI": [
    "https://www.w3.org/WebPlatform/WG/"
  ],
  "license": "w3c-software-doc",
  "wgPublicList": "www-dom",
  "wgPatentURI": [
    "https://www.w3.org/2004/01/pp-impl/83482/status"
  ],
  "subjectPrefix": "DOM-Parsing",
  "otherLinks": [
    {
      "key": "Test Suites",
      "data": [
        {
          "href": "http://w3c-test.org/domparsing/"
        },
        {
          "href": "http://w3c-test.org/html/syntax/"
        }
      ]
    },
    {
      "key": "Participate",
      "data": [
        {
          "value": "We are on Github.",
          "href": "https://github.com/w3c/DOM-Parsing"
        },
        {
          "value": "Bugzilla Bug list.",
          "href": "https://www.w3.org/Bugs/Public/buglist.cgi?component=DOM%20Parsing%20and%20Serialization&list_id=44989&product=WebAppsWG&resolution=---"
        },
        {
          "value": "Github Issues.",
          "href": "https://github.com/w3c/DOM-Parsing/issues"
        },
        {
          "value": "Commit history.",
          "href": "https://github.com/w3c/DOM-Parsing/commits"
        },
        {
          "value": "Mailing list.",
          "href": "http://lists.w3.org/Archives/Public/www-dom/"
        }
      ]
    }
  ],
  "publishISODate": "2024-04-16T00:00:00.000Z",
  "generatedSubtitle": "W3C Editor's Draft 16 April 2024"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED"></head>
<body class="h-entry" data-cite="WEBIDL webidl html"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">DOM Parsing and Serialization</h1> <h2 id="subtitle" class="subtitle">DOMParser, XMLSerializer, innerHTML, and similar APIs</h2>
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">W3C Editor's Draft</a> <time class="dt-published" datetime="2024-04-16">16 April 2024</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://w3c.github.io/DOM-Parsing/">https://w3c.github.io/DOM-Parsing/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/DOM-Parsing/">https://www.w3.org/TR/DOM-Parsing/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/DOM-Parsing/">https://w3c.github.io/DOM-Parsing/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/DOM-Parsing/">https://www.w3.org/standards/history/DOM-Parsing/</a>
                  </dd>
        
        
        
        
        
        <dt>Editor:</dt><dd class="editor p-author h-card vcard" data-editor-id="40117">
    <a class="ed_mailto u-email email p-name" href="mailto:travis.leithead@microsoft.com">Travis Leithead</a> (<a class="p-org org h-org" href="http://www.microsoft.com">Microsoft</a>)
  </dd>
        
        
        <dt>Feedback:</dt><dd><a href="mailto:www-dom@w3.org?subject=DOM-Parsing">www-dom@w3.org</a> with subject line <kbd>DOM-Parsing</kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/www-dom">archives</a>)</dd>
        
        <dt>Test Suites</dt><dd>
    <a href="http://w3c-test.org/domparsing/">http://w3c-test.org/domparsing/</a>
  </dd><dd>
    <a href="http://w3c-test.org/html/syntax/">http://w3c-test.org/html/syntax/</a>
  </dd><dt>Participate</dt><dd>
    <a href="https://github.com/w3c/DOM-Parsing">We are on Github.</a>
  </dd><dd>
    <a href="https://www.w3.org/Bugs/Public/buglist.cgi?component=DOM%20Parsing%20and%20Serialization&amp;list_id=44989&amp;product=WebAppsWG&amp;resolution=---">Bugzilla Bug list.</a>
  </dd><dd>
    <a href="https://github.com/w3c/DOM-Parsing/issues">Github Issues.</a>
  </dd><dd>
    <a href="https://github.com/w3c/DOM-Parsing/commits">Commit history.</a>
  </dd><dd>
    <a href="http://lists.w3.org/Archives/Public/www-dom/">Mailing list.</a>
  </dd>
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/policies/#copyright">Copyright</a>
    ©
    2024
    
    <a href="https://www.w3.org/">World Wide Web Consortium</a>.
    <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
    <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/copyright/software-license-2023/" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>

<section id="abstract" class="introductory"><h2>Abstract</h2>
  This specification defines APIs for the parsing and serializing of HTML and XML-based DOM nodes
  for web applications.
</section>

<section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p><p>
    This document was published by the <a href="https://www.w3.org/groups/wg/webapps">Web Applications Working Group</a> as
    an Editor's Draft. 
  </p><p>Publication as an Editor's Draft does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/webapps/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                      This document is governed by the
                      <a id="w3c_process_revision" href="https://www.w3.org/2023/Process-20231103/">03 November 2023 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                    </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#crec">Candidate Recommendation Exit Criteria</a></li><li class="tocline"><a class="tocxref" href="#extensibility">Extensibility</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#apis-for-parsing-and-serializing-dom"><bdi class="secno">2. </bdi>APIs for parsing and serializing DOM</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#the-domparser-interface"><bdi class="secno">2.1 </bdi>The <code>DOMParser</code> interface</a></li><li class="tocline"><a class="tocxref" href="#the-xmlserializer-interface"><bdi class="secno">2.2 </bdi>The <code>XMLSerializer</code> interface</a></li><li class="tocline"><a class="tocxref" href="#the-innerhtml-mixin"><bdi class="secno">2.3 </bdi>The <code>InnerHTML</code> mixin</a></li><li class="tocline"><a class="tocxref" href="#extensions-to-the-element-interface"><bdi class="secno">2.4 </bdi>Extensions to the <code><span class="formerLink" data-link-type="idl"><code>Element</code></span></code> interface</a></li><li class="tocline"><a class="tocxref" href="#extensions-to-the-range-interface"><bdi class="secno">2.5 </bdi>Extensions to the <code><span class="formerLink" data-link-type="idl"><code>Range</code></span></code> interface</a></li></ol></li><li class="tocline"><a class="tocxref" href="#algorithms-for-parsing-and-serializing"><bdi class="secno">3. </bdi>Algorithms for parsing and serializing</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#parsing"><bdi class="secno">3.1 </bdi>Parsing</a></li><li class="tocline"><a class="tocxref" href="#serializing"><bdi class="secno">3.2 </bdi>Serializing</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#xml-serialization"><bdi class="secno">3.2.1 </bdi>XML Serialization</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#xml-serializing-an-element-node"><bdi class="secno">3.2.1.1 </bdi><span>XML serializing an Element node</span></a><ol class="toc"><li class="tocline"><a class="tocxref" href="#recording-the-namespace"><bdi class="secno">3.2.1.1.1 </bdi>Recording the namespace</a></li><li class="tocline"><a class="tocxref" href="#the-namespace-prefix-map"><bdi class="secno">3.2.1.1.2 </bdi>The Namespace Prefix Map</a></li><li class="tocline"><a class="tocxref" href="#serializing-an-element-s-attributes"><bdi class="secno">3.2.1.1.3 </bdi>Serializing an Element's attributes</a></li><li class="tocline"><a class="tocxref" href="#generating-namespace-prefixes"><bdi class="secno">3.2.1.1.4 </bdi>Generating namespace prefixes</a></li></ol></li><li class="tocline"><a class="tocxref" href="#xml-serializing-a-document-node"><bdi class="secno">3.2.1.2 </bdi><span>XML serializing a Document node</span></a></li><li class="tocline"><a class="tocxref" href="#xml-serializing-a-comment-node"><bdi class="secno">3.2.1.3 </bdi><span>XML serializing a Comment node</span></a></li><li class="tocline"><a class="tocxref" href="#xml-serializing-a-text-node"><bdi class="secno">3.2.1.4 </bdi><span>XML serializing a Text node</span></a></li><li class="tocline"><a class="tocxref" href="#xml-serializing-a-documentfragment-node"><bdi class="secno">3.2.1.5 </bdi><span>XML serializing a DocumentFragment node</span></a></li><li class="tocline"><a class="tocxref" href="#xml-serializing-a-documenttype-node"><bdi class="secno">3.2.1.6 </bdi><span>XML serializing a DocumentType node</span></a></li><li class="tocline"><a class="tocxref" href="#xml-serializing-a-processinginstruction-node"><bdi class="secno">3.2.1.7 </bdi><span>XML serializing a ProcessingInstruction node</span></a></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#dependencies"><bdi class="secno">A. </bdi>Dependencies</a></li><li class="tocline"><a class="tocxref" href="#revision-history"><bdi class="secno">B. </bdi>Revision History</a></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">C. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>Normative references</a></li></ol></li></ol></nav>

<section id="crec" class="introductory"><div class="header-wrapper"><h2 id="candidate-recommendation-exit-criteria">Candidate Recommendation Exit Criteria</h2><a class="self-link" href="#crec" aria-label="Permalink for this Section"></a></div>
  

  This specification will not advance to Proposed Recommendation before the spec's
  <a href="http://w3c-test.org/domparsing/">test suite</a> is completed and two or more independent
  implementations pass each test, although no single implementation must pass each test. We expect
  to meet this criteria no sooner than 24 October 2014. The group will also create an
  <a href="https://dvcs.w3.org/hg/innerhtml/raw-file/tip/implementationReport.html">Implementation
  Report</a>.
</section>

<section id="conformance" class="introductory"><h1>Conformance</h1><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p>
  <p>The IDL fragments in this specification must be interpreted as required for conforming IDL
  fragments, as described in the Web IDL specification. [<cite class="respec-offending-element" title="Normative references in informative sections are not allowed. " id="respec-offender-normative-references-in-informative-sections-are-not-allowed"><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>]

  </p><p>Requirements phrased in the imperative as part of algorithms (such as "strip any leading space
  characters" or "return false and terminate these steps") are to be interpreted with the meaning of
  the key word ("must", "should", "may", etc) used in introducing the algorithm.

  </p><p>Conformance requirements phrased as algorithms or specific steps may be implemented in any
  manner, so long as the end result is equivalent. (In particular, the algorithms defined in this
  specification are intended to be easy to follow, and not intended to be performant.)

  </p><p>User agents may impose implementation-specific limits on otherwise unconstrained inputs, e.g.
  to prevent denial of service attacks, to guard against running out of memory, or to work around
  platform-specific limitations.

  </p><p>When a method or an attribute is said to call another method or attribute, the user agent must
  invoke its internal API for that attribute or method so that e.g. the author can't change the
  behavior by overriding attributes or methods with custom properties or functions in ECMAScript.
  [<cite><a class="bibref" data-link-type="biblio" href="#bib-ecma-262" title="ECMAScript Language Specification">ECMA-262</a></cite>]

  </p><p>Unless otherwise stated, string comparisons are done in a <a href="#dfn-case-sensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-case-sensitive-1">case-sensitive</a> manner.

  </p><p>If an algorithm calls into another algorithm, any exception that is thrown by the latter
  (unless it is explicitly caught), must cause the former to terminate, and the exception to be
  propagated up to its caller.
</p></section>

<section class="introductory" id="extensibility"><div class="header-wrapper"><h2 id="extensibility-0">Extensibility</h2><a class="self-link" href="#extensibility" aria-label="Permalink for this Section"></a></div>
  

  <p>Vendor-specific proprietary extensions to this specification are strongly discouraged. Authors
  must not use such extensions, as doing so reduces interoperability and fragments the user base,
  allowing only users of specific user agents to access the content in question.

  </p><p>If vendor-specific extensions are needed, the members should be prefixed by vendor-specific
  strings to prevent clashes with future versions of this specification. Extensions must be defined
  so that the use of extensions neither contradicts nor causes the non-conformance of functionality
  defined in the specification.

  </p><p>When vendor-neutral extensions to this specification are needed, either this specification can
  be updated accordingly, or an extension specification can be written that overrides the
  requirements in this specification. Such an extension specification becomes an
  <dfn id="dfn-applicable-specification" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;applicable specification&quot;, but nothing links to it. This is usually a spec bug!">applicable specification</dfn> for the purposes of conformance requirements in this
  specification.
  
</p></section>

<section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>

  <p>A document object model (DOM) is an in-memory representation of various types of <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-1">Node</a>s
  where each <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-2">Node</a> is connected in a tree. The [<cite><a class="bibref" data-link-type="biblio" href="#bib-html5" title="HTML5">HTML5</a></cite>] and [<cite><a class="bibref" data-link-type="biblio" href="#bib-dom4" title="DOM Standard">DOM4</a></cite>] specifications describe
  DOM and its <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-3">Node</a>s is greater detail.

  </p><p><dfn id="dfn-parsing" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Parsing</dfn> is the term used for converting a string representation of a DOM into an
  actual DOM, and <dfn id="dfn-serializing" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Serializing</dfn> is the term used to transform a DOM back into a string.
  This specification concerns itself with defining various APIs for both parsing and serializing a
  DOM.

  </p><div class="example">For example: the <a href="#dfn-innerhtml" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-innerhtml-1">innerHTML</a> API is a common way to both
  parse and serialize a DOM (it does both). If a particular <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-4">Node</a>, has the following in-memory
  DOM:
  <pre aria-busy="false"><code class="hljs css">HTMLDivElement (nodeName: <span class="hljs-string">"div"</span>)
┃
┣━ HTMLSpanElement (nodeName: <span class="hljs-string">"span"</span>)
┃  ┃
┃  ┗━ Text (data: <span class="hljs-string">"some "</span>)
┃
┗━ HTMLElement (nodeName: <span class="hljs-string">"em"</span>)
   ┃
   ┗━ Text (data: <span class="hljs-string">"text!"</span>)</code></pre>
  And the <code>HTMLDivElement</code> node is stored in a variable <code><var>myDiv</var></code>,
  then to serialize <code><var>myDiv</var></code>'s children simply <em>get</em> (read) the
  <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-1"><code>Element</code></a>'s <a href="#dfn-innerhtml" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-innerhtml-2">innerHTML</a> property (this triggers the serialization):

  <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">var</span> serializedChildren = myDiv.innerHTML;
<span class="hljs-comment">// serializedChildren has the value:</span>
<span class="hljs-comment">// "&lt;span&gt;some &lt;/span&gt;&lt;em&gt;text!&lt;/em&gt;"</span></code></pre>

  <p>To parse new children for <code><var>myDiv</var></code> from a string (replacing its existing
  children), simply <em>set</em> the <a href="#dfn-innerhtml" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-innerhtml-3">innerHTML</a> property (this triggers
  parsing of the assigned string):

  </p><pre aria-busy="false"><code class="hljs javascript">myDiv.innerHTML = <span class="hljs-string">"&lt;span&gt;new&lt;/span&gt;&lt;em&gt;children!&lt;/em&gt;"</span>;</code></pre>
  </div>

  <p>This specification describes two flavors of <a href="#dfn-parsing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-parsing-1">parsing</a> and <a href="#dfn-serializing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-serializing-1">serializing</a>: HTML and
  XML (with XHTML being a type of XML). Each follows the rules of its respective markup language.
  The above example shows HTML parsing and serialization. The specific algorithms for HTML parsing
  and serializing are defined in the [<cite><a class="bibref" data-link-type="biblio" href="#bib-html5" title="HTML5">HTML5</a></cite>] specification. This specification contains the
  algorithm for XML serializing. The grammar for XML parsing is described in the [<cite><a class="bibref" data-link-type="biblio" href="#bib-xml10" title="Extensible Markup Language (XML) 1.0 (Fifth Edition)">XML10</a></cite>]
  specification.

  </p><p><dfn id="dfn-round-tripping" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Round-tripping</dfn> a DOM means to serialize and then immediately parse the serialized
  string back into a DOM. Ideally, this process does not result in any data loss with respect to the
  identity and attributes of the <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-5">Node</a> in the DOM.

  <a href="#dfn-round-tripping" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-round-tripping-1">Round-tripping</a> is especially tricky for an XML serialization, which must be concerned with
  preserving the <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-6">Node</a>'s namespace identity in the serialization (wereas namespaces are
  ignored in HTML).

  </p><div class="example">Consider the XML serialization of the following in-memory DOM:
  <pre aria-busy="false"><code class="hljs css">Element (nodeName: <span class="hljs-string">"root"</span>)
┃
┗━ HTMLScriptElement (nodeName: <span class="hljs-string">"script"</span>)
   ┃
   ┗━ Text (data: <span class="hljs-string">"alert('hello world')"</span>)</code></pre>
  An XML serialization must include the <code>HTMLScriptElement</code> <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-7">Node</a>'s
  <a data-lt="concept namespace" href="#dfn-concept-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-concept-namespace-1">namespace</a> in order to preserve the identity of the
  <code>script</code> element, and to allow the serialized string to
  <a data-lt="round-tripping" href="#dfn-round-tripping" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-round-tripping-2">round-trip</a> through an XML parser. Assuming that <code>root</code>
  is in a variable named <code><var>root</var></code>:

  <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">var</span> xmlSerialization = <span class="hljs-keyword">new</span> XMLSerializer().serializeToString(root);
<span class="hljs-comment">// xmlSerialization has the value:</span>
<span class="hljs-comment">// "&lt;root&gt;&lt;script xmlns="http://www.w3.org/1999/xhtml"&gt;alert('hello world')&lt;/script&gt;&lt;/root&gt;"</span></code></pre>
  </div>

  <p>The term <dfn id="dfn-context-object" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">context object</dfn> means the object on which the API being discussed was
  called.

  </p><p>The following terms are understood to represent their respective namespaces in this
  specification (and makes it easier to read):

  </p><ul>
    <li>The <dfn id="dfn-html-namespace" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">HTML namespace</dfn> is <code>http://www.w3.org/1999/xhtml</code>
    </li><li>The <dfn id="dfn-xml-namespace" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML namespace</dfn> is <code>http://www.w3.org/XML/1998/namespace</code>
    </li><li>The <dfn id="dfn-xmlns-namespace" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XMLNS namespace</dfn> is <code>http://www.w3.org/2000/xmlns/</code>
  </li></ul>

</section>

<section id="apis-for-parsing-and-serializing-dom"><div class="header-wrapper"><h2 id="x2-apis-for-parsing-and-serializing-dom"><bdi class="secno">2. </bdi>APIs for parsing and serializing DOM</h2><a class="self-link" href="#apis-for-parsing-and-serializing-dom" aria-label="Permalink for Section 2."></a></div>

<section id="the-domparser-interface"><div class="header-wrapper"><h3 id="x2-1-the-domparser-interface"><bdi class="secno">2.1 </bdi>The <code>DOMParser</code> interface</h3><a class="self-link" href="#the-domparser-interface" aria-label="Permalink for Section 2.1"></a></div>

  <span id="dom-domparser"></span>
  <span id="dom-domparser-parsefromstring"></span>
  <span id="idl-def-supportedtype"></span>
  <span id="dom-supportedtype-text/html"></span>
  <span id="dom-supportedtype-text/xml"></span>
  <span id="dom-supportedtype-application/xml"></span>
  <span id="dom-supportedtype-application/xhtml+xml"></span>
  <span id="dom-supportedtype-image/svg+xml"></span>

  <p>The definition of <code>DOMParser</code> has moved to <a href="https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#domparser">the HTML Standard</a>.</p>

</section>

<section id="the-xmlserializer-interface"><div class="header-wrapper"><h3 id="x2-2-the-xmlserializer-interface"><bdi class="secno">2.2 </bdi>The <code>XMLSerializer</code> interface</h3><a class="self-link" href="#the-xmlserializer-interface" aria-label="Permalink for Section 2.2"></a></div>

  <pre class="idl def" id="webidl-1703602265"><span class="idlHeader"><a class="self-link" href="#webidl-1703602265">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-xmlserializer" data-title="XMLSerializer">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-xmlserializer" id="ref-for-dom-xmlserializer-1"><code>XMLSerializer</code></a> {<span data-idl="" class="idlConstructor" id="idl-def-xmlserializer-constructor" data-title="constructor" data-dfn-for="XMLSerializer">
  <dfn data-export="" data-dfn-type="constructor" id="dom-xmlserializer-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="XMLSerializer" data-lt="constructor()" data-local-lt="XMLSerializer.constructor|XMLSerializer.constructor()|constructor" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>();</span><span data-idl="" class="idlMethod" id="idl-def-xmlserializer-serializetostring-root" data-title="serializeToString" data-dfn-for="XMLSerializer"><span class="idlType">
  <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-xmlserializer-serializetostring" id="ref-for-dom-xmlserializer-serializetostring-1"><code>serializeToString</code></a>(<span class="idlType"><a data-link-type="idl" href="#dfn-node" class="internalDFN" id="ref-for-dfn-node-8">Node</a></span> <span class="idlParamName">root</span>);</span>
};</span></code></pre>

  <dl class="domintro">
    <dt><var>xmlserializer</var> = new <a href="#dom-xmlserializer" class="internalDFN" data-link-type="idl" id="ref-for-dom-xmlserializer-2"><code>XMLSerializer</code></a> ()
    </dt><dd>Constructs a new XMLSerializer object.

    </dd><dt><var>string</var> = <var>xmlserializer</var> . <a href="#dom-xmlserializer-serializetostring" class="internalDFN" data-link-type="idl" id="ref-for-dom-xmlserializer-serializetostring-2"><code>serializeToString</code></a> ( <var>root</var> )
    </dt><dd>Serializes <var>root</var> into a string using an XML serialization. Throws a
    <a href="#dfn-typeerror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-typeerror-1">TypeError</a> exception if <var>root</var> is not a <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-9">Node</a> or an <a href="#dfn-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attribute-1">Attr</a> object.
  </dd></dl>

  <p>The <dfn data-export="" data-dfn-type="interface" id="dom-xmlserializer" data-idl="interface" data-title="XMLSerializer" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>XMLSerializer</code></dfn>() constructor must return a new <a href="#dom-xmlserializer" class="internalDFN" data-link-type="idl" id="ref-for-dom-xmlserializer-3"><code>XMLSerializer</code></a>
  object.

  </p><p>The <dfn data-dfn-for="XMLSerializer" data-export="" data-dfn-type="method" id="dom-xmlserializer-serializetostring" data-idl="operation" data-title="serializeToString" data-type="DOMString" data-lt="serializeToString()|serializeToString(root)" data-local-lt="XMLSerializer.serializeToString|XMLSerializer.serializeToString()|serializeToString" tabindex="0" aria-haspopup="dialog"><code>serializeToString</code></dfn>(<var>root</var>) method must
  produce an <a href="#dfn-xml-serialization" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-1">XML serialization</a> of <var>root</var> passing a value of <code>false</code> for
  the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-1"><var>require well-formed</var></a> parameter, and return the result.

</p></section>

<section id="the-innerhtml-mixin"><div class="header-wrapper"><h3 id="x2-3-the-innerhtml-mixin"><bdi class="secno">2.3 </bdi>The <code>InnerHTML</code> mixin</h3><a class="self-link" href="#the-innerhtml-mixin" aria-label="Permalink for Section 2.3"></a></div>

  <span id="dom-innerhtml"></span>

  <p>The definition of <code>InnerHTML</code> has moved to <a href="https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#the-innerhtml-property">the HTML Standard</a>.</p>

</section>

<section id="extensions-to-the-element-interface"><div class="header-wrapper"><h3 id="x2-4-extensions-to-the-element-interface"><bdi class="secno">2.4 </bdi>Extensions to the <code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-2"><code>Element</code></a></code> interface</h3><a class="self-link" href="#extensions-to-the-element-interface" aria-label="Permalink for Section 2.4"></a></div>

  <pre class="idl def" id="webidl-1069524514"><span class="idlHeader"><a class="self-link" href="#webidl-1069524514">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-element-partial-1" data-title="Element">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-element" id="ref-for-dom-element-3"><code>Element</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-element-outerhtml" data-title="outerHTML" data-dfn-for="Element">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">CEReactions</a></span>] attribute<span class="idlType"> [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#LegacyNullToEmptyString">LegacyNullToEmptyString</a></span>] <a data-link-type="idl" href="#dfn-htmlstring" class="internalDFN" id="ref-for-dfn-htmlstring-1">HTMLString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-element-outerhtml" id="ref-for-dom-element-outerhtml-1"><code>outerHTML</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-element-insertadjacenthtml-position-text" data-title="insertAdjacentHTML" data-dfn-for="Element">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">CEReactions</a></span>]<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-element-insertadjacenthtml" id="ref-for-dom-element-insertadjacenthtml-1"><code>insertAdjacentHTML</code></a>(<span class="idlType"><a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">position</span>,<span class="idlType"> <a data-link-type="idl" href="#dfn-htmlstring" class="internalDFN" id="ref-for-dfn-htmlstring-2">HTMLString</a></span> <span class="idlParamName">text</span>);</span>
};</span></code></pre>

  

  <p>The <dfn data-dfn-for="Element" data-export="" data-dfn-type="attribute" id="dom-element-outerhtml" data-idl="attribute" data-title="outerHTML" data-type="HTMLString" data-lt="outerHTML" data-local-lt="Element.outerHTML" tabindex="0" aria-haspopup="dialog"><code>outerHTML</code></dfn> IDL attribute represents the markup of the
  <code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-4"><code>Element</code></a></code> and its contents.

  </p><dl class="domintro">
    <dt><var>element</var> . <a href="#dom-element-outerhtml" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-outerhtml-2"><code>outerHTML</code></a> [ = <var>value</var> ]
    </dt><dd>Returns a fragment of HTML or XML that represents the element and its contents.

    <p>Can be set, to replace the element with nodes parsed from the given string.

    </p><p>In the case of an <a href="#dfn-xml-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-document-1">XML document</a>, throws a "<code><a href="#dfn-invalidstateerror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-invalidstateerror-1">InvalidStateError</a></code>"
    <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-1">DOMException</a></code> if the element cannot be serialized to XML, or a
    "<code><a href="#dfn-syntaxerror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-syntaxerror-1">SyntaxError</a></code>" <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-2">DOMException</a></code> if the given string is not
    well-formed.

    </p><p>Throws a "<code><a href="#dfn-nomodificationallowederror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-nomodificationallowederror-1">NoModificationAllowedError</a></code>" <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-3">DOMException</a></code>
    if the parent of the element is a <code><a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-1">Document</a></code>.
  </p></dd></dl>

  <p>On getting, return the result of invoking the <a href="#dfn-fragment-serializing-algorithm-0" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-fragment-serializing-algorithm-0-1">fragment serializing algorithm</a> on a
  fictional node whose only child is the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-1">context object</a> providing <code>true</code> for the
  <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-2"><var>require well-formed</var></a> flag (this might throw an exception instead of returning a string).

  </p><p>On setting, the following steps must be run:

  </p><ol>
    <li>Let <var>parent</var> be the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-2">context object</a>'s <a href="#dfn-parent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-parent-1">parent</a>.

    </li><li>If <var>parent</var> is null, terminate these steps. There would be no way to obtain a
    reference to the nodes created even if the remaining steps were run.

    </li><li>If <var>parent</var> is a <code><a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-2">Document</a></code>, throw a
    "<code><a href="#dfn-nomodificationallowederror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-nomodificationallowederror-2">NoModificationAllowedError</a></code>" <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-4">DOMException</a></code>.

    </li><li>If <var>parent</var> is a <code><a href="#dfn-documentfragment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentfragment-1">DocumentFragment</a></code>, let <var>parent</var> be a
    new <code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-5"><code>Element</code></a></code> with:

    <ul>
      <li><code>body</code> as its <a href="#dfn-local-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-name-1">local name</a>,

      </li><li>The <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-1">HTML namespace</a> as its <a data-lt="concept namespace" href="#dfn-concept-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-concept-namespace-2">namespace</a>, and

      </li><li>The <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-3">context object</a>'s <a href="#dfn-node-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-document-1">node document</a> as its <a href="#dfn-node-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-document-2">node document</a>.
    </li></ul>

    </li><li>Let <var>fragment</var> be the result of invoking the <a href="#dfn-fragment-parsing-algorithm-0" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-fragment-parsing-algorithm-0-1">fragment parsing algorithm</a> with
    the new value as <var>markup</var>, and <var>parent</var> as the <var>context element</var>.

    </li><li><a href="#dfn-replace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-replace-1">Replace</a> the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-4">context object</a> with <var>fragment</var> within the
    <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-5">context object</a>'s <a href="#dfn-parent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-parent-2">parent</a>.
  </li></ol>

  

  <dl class="domintro">
    <dt><var>element</var> . <a href="#dom-element-insertadjacenthtml" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-insertadjacenthtml-2"><code>insertAdjacentHTML</code></a> ( <var>position</var>, <var>text</var> )
    </dt><dd>Parses the given string <var>text</var> as HTML or XML and inserts the resulting nodes into
    the tree in the position given by the <var>position</var> argument, as follows:

    <dl>
      <dt>"beforebegin"
      </dt><dd>Before the element itself (i.e., after <var>element</var>'s previous sibling)

      </dd><dt>"afterbegin"
      </dt><dd>Just inside the element, before its first child.

      </dd><dt>"beforeend"
      </dt><dd>Just inside the element, after its last child.

      </dd><dt>"afterend"
      </dt><dd>After the element itself (i.e., before <var>element</var>'s next sibling)
    </dd></dl>

    <p>Throws a "<code><a href="#dfn-syntaxerror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-syntaxerror-2">SyntaxError</a></code>" <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-5">DOMException</a></code> if the arguments
    have invalid values (e.g., in the case of an <a href="#dfn-xml-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-document-2">XML document</a>, if the given string is not
    well-formed).

    </p><p>Throws a "<code><a href="#dfn-nomodificationallowederror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-nomodificationallowederror-3">NoModificationAllowedError</a></code>" <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-6">DOMException</a></code> if
    the given position isn't possible (e.g. inserting elements after the root element of a
    <code><a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-3">Document</a></code>).
  </p></dd></dl>

  <p>The
  <dfn data-dfn-for="Element" data-lt="insertAdjacentHTML(position, text)|insertAdjacentHTML()" data-export="" data-dfn-type="method" id="dom-element-insertadjacenthtml" data-idl="operation" data-title="insertAdjacentHTML(position, text)" data-type="undefined" data-local-lt="Element.insertAdjacentHTML|Element.insertAdjacentHTML()|insertAdjacentHTML" tabindex="0" aria-haspopup="dialog"><code>insertAdjacentHTML(<var>position</var>, <var>text</var>)</code></dfn>
  method must run these steps:

  </p><ol>
    <li>Use the first matching item from this list:

    <dl class="switch">
      <dt>If <var>position</var> is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-1">ASCII case-insensitive</a> match for the string
      "<code>beforebegin</code>"
      </dt><dt>If <var>position</var> is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-2">ASCII case-insensitive</a> match for the string
      "<code>afterend</code>"
      </dt><dd>Let <var>context</var> be the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-6">context object</a>'s <a href="#dfn-parent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-parent-3">parent</a>.

      <p>If <var>context</var> is null or a <a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-4">Document</a>, throw a
      "<code><a href="#dfn-nomodificationallowederror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-nomodificationallowederror-4">NoModificationAllowedError</a></code>" <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-7">DOMException</a></code>.

      </p></dd><dt>If <var>position</var> is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-3">ASCII case-insensitive</a> match for the string
      "<code>afterbegin</code>"
      </dt><dt>If <var>position</var> is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-4">ASCII case-insensitive</a> match for the string
      "<code>beforeend</code>"
      </dt><dd>Let <var>context</var> be the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-7">context object</a>.

      </dd><dt>Otherwise
      </dt><dd>Throw a "<code><a href="#dfn-syntaxerror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-syntaxerror-3">SyntaxError</a></code>" <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-8">DOMException</a></code>.
    </dd></dl>

    </li><li>If <var>context</var> is not an <code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-6"><code>Element</code></a></code> or the following are all true:
    <ul>
      <li><var>context</var>'s <a href="#dfn-node-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-document-3">node document</a> is an <a href="#dfn-html-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-document-1">HTML document</a>,

      </li><li><var>context</var>'s <a href="#dfn-local-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-name-2">local name</a> is "<code>html</code>", and

      </li><li><var>context</var>'s <a data-lt="concept namespace" href="#dfn-concept-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-concept-namespace-3">namespace</a> is the
      <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-2">HTML namespace</a>;
    </li></ul>

    <p>let <var>context</var> be a new <code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-7"><code>Element</code></a></code> with

    </p><ul>
      <li><code>body</code> as its <a href="#dfn-local-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-name-3">local name</a>,

      </li><li>The <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-3">HTML namespace</a> as its <a data-lt="concept namespace" href="#dfn-concept-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-concept-namespace-4">namespace</a>, and

      </li><li>The <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-8">context object</a>'s <a href="#dfn-node-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-document-4">node document</a> as its <a href="#dfn-node-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-document-5">node document</a>.
    </li></ul>

    </li><li>Let <var>fragment</var> be the result of invoking the <a href="#dfn-fragment-parsing-algorithm-0" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-fragment-parsing-algorithm-0-2">fragment parsing algorithm</a> with
    <var>text</var> as <var>markup</var>, and <var>context</var> as the <var>context element</var>.

    </li><li>Use the first matching item from this list:

    <dl class="switch">
      <dt>If <var>position</var> is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-5">ASCII case-insensitive</a> match for the string
      "<code>beforebegin</code>"
      </dt><dd><a href="#dfn-insert" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-insert-1">Insert</a> <var>fragment</var> into the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-9">context object</a>'s <a href="#dfn-parent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-parent-4">parent</a> before
      the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-10">context object</a>.

      </dd><dt>If <var>position</var> is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-6">ASCII case-insensitive</a> match for the string
      "<code>afterbegin</code>"
      </dt><dd><a href="#dfn-insert" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-insert-2">Insert</a> <var>fragment</var> into the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-11">context object</a> before its
      <a href="#dfn-first-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-first-child-1">first child</a>.

      </dd><dt>If <var>position</var> is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-7">ASCII case-insensitive</a> match for the string
      "<code>beforeend</code>"
      </dt><dd><a href="#dfn-append" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-append-1">Append</a> <var>fragment</var> to the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-12">context object</a>.

      </dd><dt>If <var>position</var> is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-8">ASCII case-insensitive</a> match for the string
      "<code>afterend</code>"
      </dt><dd><a href="#dfn-insert" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-insert-3">Insert</a> <var>fragment</var> into the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-13">context object</a>'s <a href="#dfn-parent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-parent-5">parent</a> before
      the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-14">context object</a>'s <a href="#dfn-next-sibling" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-next-sibling-1">next sibling</a>.
    </dd></dl>
  </li></ol>

  <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span></div><p class="">No special handling for <code><a href="#dfn-template" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-1">template</a></code> elements is included in the
  above "<code>afterbegin</code>" and "<code>beforeend</code>" cases. As with other direct
  <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-10">Node</a>-manipulation APIs (and unlike <a href="#dfn-innerhtml" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-innerhtml-4">innerHTML</a>),
  <a href="#dom-element-insertadjacenthtml" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-insertadjacenthtml-3"><code>insertAdjacentHTML</code></a> does not include any special handling for
  <code><a href="#dfn-template" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-2">template</a></code> elements. In most cases you will wish to use
  <a href="#dfn-template" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-3">template</a>.<a data-lt="template contents" href="#dfn-template-content" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-content-1">content</a>.<a href="#dom-element-insertadjacenthtml" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-insertadjacenthtml-4"><code>insertAdjacentHTML</code></a>
  instead of directly manipulating the <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-1">child nodes</a> of a <code><a href="#dfn-template" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-4">template</a></code>
  element.</p></div>

</section>

<section id="extensions-to-the-range-interface"><div class="header-wrapper"><h3 id="x2-5-extensions-to-the-range-interface"><bdi class="secno">2.5 </bdi>Extensions to the <code><a href="#dom-range" class="internalDFN" data-link-type="idl" id="ref-for-dom-range-1"><code>Range</code></a></code> interface</h3><a class="self-link" href="#extensions-to-the-range-interface" aria-label="Permalink for Section 2.5"></a></div>

  <pre class="idl def" id="webidl-1881988415"><span class="idlHeader"><a class="self-link" href="#webidl-1881988415">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-range-partial-1" data-title="Range">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-range" id="ref-for-dom-range-2"><code>Range</code></a> {<span data-idl="" class="idlMethod" id="idl-def-range-createcontextualfragment-fragment" data-title="createContextualFragment" data-dfn-for="Range">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">CEReactions</a></span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject">NewObject</a></span>]<span class="idlType"> <a data-link-type="idl" href="#dfn-documentfragment" class="internalDFN" id="ref-for-dfn-documentfragment-2">DocumentFragment</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-range-createcontextualfragment" id="ref-for-dom-range-createcontextualfragment-1"><code>createContextualFragment</code></a>(<span class="idlType"><a data-link-type="idl" href="#dfn-htmlstring" class="internalDFN" id="ref-for-dfn-htmlstring-3">HTMLString</a></span> <span class="idlParamName">fragment</span>);</span>
};</span></code></pre>

  <dl class="domintro">
    <dt><var>docFragment</var> = <var>range</var> . <a href="#dom-range-createcontextualfragment" class="internalDFN" data-link-type="idl" id="ref-for-dom-range-createcontextualfragment-2"><code>createContextualFragment</code></a> ( <var>fragment</var> )
    </dt><dd>Returns a <code><a href="#dfn-documentfragment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentfragment-3">DocumentFragment</a></code>, created from the markup string
    <var>fragment</var> using <var>range</var>'s start node as the context in which
    <var>fragment</var> is parsed.
  </dd></dl>

  <p>The <dfn data-dfn-for="Range" data-lt="createContextualFragment(fragment)|createContextualFragment()" data-export="" data-dfn-type="method" id="dom-range-createcontextualfragment" data-idl="operation" data-title="createContextualFragment(fragment)" data-type="DocumentFragment" data-local-lt="Range.createContextualFragment|Range.createContextualFragment()|createContextualFragment" tabindex="0" aria-haspopup="dialog"><code>createContextualFragment(<var>fragment</var>)</code></dfn> method
  must run these steps:

  </p><ol>
    <li>Let <var>node</var> be the <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-15">context object</a>'s <a href="#dfn-start-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-start-node-1">start node</a>.

    <p>Let <var>element</var> be as follows, depending on <var>node</var>'s interface:

    </p><dl class="switch">
      <dt><code><a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-5">Document</a></code>
      </dt><dt><code><a href="#dfn-documentfragment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentfragment-4">DocumentFragment</a></code>
      </dt><dd>null

      </dd><dt><code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-8"><code>Element</code></a></code>
      </dt><dd><var>node</var>

      </dd><dt><code><a href="#dfn-text" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-1">Text</a></code>
      </dt><dt><code><a href="#dfn-comment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-comment-1">Comment</a></code>
      </dt><dd><var>node</var>'s <a href="https://dom.spec.whatwg.org/#parent-element">parent element</a>

      </dd><dt><code><a href="#dfn-documenttype" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documenttype-1">DocumentType</a></code>
      </dt><dt><code><a href="#dfn-processinginstruction" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-processinginstruction-1">ProcessingInstruction</a></code>
      </dt><dd>[<cite><a class="bibref" data-link-type="biblio" href="#bib-dom4" title="DOM Standard">DOM4</a></cite>] prevents this case.
    </dd></dl>

    </li><li>If either <var>element</var> is null or the following are all true:

    <ul>
      <li><var>element</var>'s <a href="#dfn-node-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-document-6">node document</a> is an <a href="#dfn-html-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-document-2">HTML document</a>,

      </li><li><var>element</var>'s <a href="#dfn-local-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-name-4">local name</a> is "<code>html</code>", and

      </li><li><var>element</var>'s <a data-lt="concept namespace" href="#dfn-concept-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-concept-namespace-5">namespace</a> is the
      <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-4">HTML namespace</a>;
    </li></ul>

    <p>let <var>element</var> be a new <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-9"><code>Element</code></a> with

    </p><ul>
      <li>"<code>body</code>" as its <a href="#dfn-local-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-name-5">local name</a>,

      </li><li>The <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-5">HTML namespace</a> as its <a data-lt="concept namespace" href="#dfn-concept-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-concept-namespace-6">namespace</a>, and

      </li><li>The <a href="#dfn-context-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-object-16">context object</a>'s <a href="#dfn-node-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-document-7">node document</a> as its <a href="#dfn-node-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-document-8">node document</a>.
    </li></ul>

    </li><li>Let <var>fragment node</var> be the result of invoking the <a href="#dfn-fragment-parsing-algorithm-0" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-fragment-parsing-algorithm-0-3">fragment parsing algorithm</a>
    with <var>fragment</var> as <var>markup</var>, and <var>element</var> as the
    <var>context element</var>.

    </li><li>Unmark all scripts in <var>fragment node</var> as "already started" and as "parser-inserted".

    </li><li>Return the value of <var>fragment node</var>.
  </li></ol>
</section>




</section>

<section id="algorithms-for-parsing-and-serializing"><div class="header-wrapper"><h2 id="x3-algorithms-for-parsing-and-serializing"><bdi class="secno">3. </bdi>Algorithms for parsing and serializing</h2><a class="self-link" href="#algorithms-for-parsing-and-serializing" aria-label="Permalink for Section 3."></a></div>

<section id="parsing"><div class="header-wrapper"><h3 id="x3-1-parsing"><bdi class="secno">3.1 </bdi>Parsing</h3><a class="self-link" href="#parsing" aria-label="Permalink for Section 3.1"></a></div>

  <span id="dfn-fragment-parsing-algorithm"></span>

  <p>The definition of <code>fragment parsing algorithm</code> has moved to <a href="https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#fragment-parsing-algorithm-steps">the HTML Standard</a>.</p>

</section>

<section id="serializing"><div class="header-wrapper"><h3 id="x3-2-serializing"><bdi class="secno">3.2 </bdi>Serializing</h3><a class="self-link" href="#serializing" aria-label="Permalink for Section 3.2"></a></div>

  <span id="dfn-fragment-serializing-algorithm"></span>

  <p>The definition of <code>fragment serializing algorithm</code> has moved to <a href="https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#fragment-serializing-algorithm-steps">the HTML Standard</a>.</p>

<section id="xml-serialization"><div class="header-wrapper"><h4 id="x3-2-1-xml-serialization"><bdi class="secno">3.2.1 </bdi>XML Serialization</h4><a class="self-link" href="#xml-serialization" aria-label="Permalink for Section 3.2.1"></a></div>

  <p>An <a href="#dfn-xml-serialization" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-2">XML serialization</a> differs from an HTML serialization in the following ways:

  </p><ul>
    <li><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-10"><code>Elements</code></a> and <a data-lt="attribute" href="#dfn-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attribute-2">attributes</a> will always be serialized such
    that their <code>namespaceURI</code> is preserved. In some cases this means that an existing
    <code>prefix</code>, prefix declaration attribute or default namespace declaration attribute
    might be dropped, substituted or changed. An HTML serialization does not attempt to
    preserve the <code>namespaceURI</code>.

    </li><li><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-11"><code>Elements</code></a> not in the <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-6">HTML namespace</a> containing no <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-2">children</a>, are
    serialized using the <a href="#dfn-empty-element-tag" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-empty-element-tag-1">empty-element tag</a> syntax (i.e., according to the XML
    <a href="#dfn-emptyelemtag" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-emptyelemtag-1">EmptyElemTag</a> production).
  </li></ul>

  <p>Otherwise, the algorithm for producing an <a href="#dfn-xml-serialization" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-3">XML serialization</a> is designed to produce a
  serialization that is compatible with the <a href="#dfn-html-parser" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-parser-1">HTML parser</a>. For example, elements in the
  <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-7">HTML namespace</a> that contain no <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-3">child nodes</a> are serialized with an explicit begin and end
  tag rather than using the <a href="#dfn-empty-element-tag" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-empty-element-tag-2">empty-element tag</a> syntax.

  </p><div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="5"><span>Note</span></div><p class="">Per [<cite><a class="bibref" data-link-type="biblio" href="#bib-dom4" title="DOM Standard">DOM4</a></cite>], <code><a href="#dfn-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attribute-3">Attr</a></code> objects do not inherit from <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-11">Node</a>, and
  thus cannot be serialized by the <a href="#dfn-xml-serialization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-algorithm-1">XML serialization algorithm</a>. An attempt to serialize an
  <a href="#dfn-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attribute-4">Attr</a> object will result in an empty string.

  </p></div><p>To produce an <dfn id="dfn-xml-serialization" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serialization</dfn> of a <code><a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-12">Node</a></code> <var>node</var> given
  a flag <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-3"><dfn id="dfn-require-well-formed" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">require well-formed</dfn></a>, run the following steps:

  </p><ol>
    <li>Let <a href="#dfn-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-1"><var>namespace</var></a> be a <a href="#dfn-context-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-namespace-1">context namespace</a> with value <code>null</code>.
    The <dfn id="dfn-context-namespace" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">context namespace</dfn> tracks the <a href="#dfn-xml-serialization" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-4">XML serialization</a> algorithm's current default
    namespace. The <a href="#dfn-context-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-namespace-2">context namespace</a> is changed when either an <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-12"><code>Element</code></a> <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-13">Node</a> has
    a default namespace declaration, or the algorithm generates a default namespace declaration for
    the <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-13"><code>Element</code></a> <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-14">Node</a> to match its own namespace. The algorithm assumes no namespace
    (<code>null</code>) to start.

    </li><li>Let <a href="#dfn-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-map-1"><var>prefix map</var></a> be a new <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-1">namespace prefix map</a>.

    </li><li><a href="#dfn-add" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-add-1">Add</a> the <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-1">XML namespace</a> with prefix value "<code>xml</code>" to
    <a href="#dfn-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-map-2"><var>prefix map</var></a>.

    </li><li>Let <a href="#dfn-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-index-1"><var>prefix index</var></a> be a <a href="#dfn-generated-namespace-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generated-namespace-prefix-index-1">generated namespace prefix index</a> with value
    <code>1</code>. The <dfn id="dfn-generated-namespace-prefix-index" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">generated namespace prefix index</dfn> is used to generate a new unique
    prefix value when no suitable existing namespace prefix is available to serialize a
    <var>node</var>'s <code>namespaceURI</code> (or the <code>namespaceURI</code> of one of
    <var>node</var>'s attributes). <span class="note">See the <a href="#dfn-generating-a-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generating-a-prefix-1">generate a prefix</a> algorithm.
    </span>

    </li><li>Return the result of running the <a href="#dfn-xml-serialization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-algorithm-2">XML serialization algorithm</a> on <var>node</var>
    passing the <a href="#dfn-context-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-namespace-3">context namespace</a> <a href="#dfn-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-2"><var>namespace</var></a>, <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-2">namespace prefix map</a>
    <a href="#dfn-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-map-3"><var>prefix map</var></a>, <a href="#dfn-generated-namespace-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generated-namespace-prefix-index-2">generated namespace prefix index</a> reference to
    <a href="#dfn-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-index-2"><var>prefix index</var></a>, and the flag <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-4"><var>require well-formed</var></a>. If an
    <dfn data-lt="throw an exception|exception" id="dfn-throw-an-exception" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">exception</dfn> occurs during the execution of the algorithm,
    then catch that exception and throw an "<code><a href="#dfn-invalidstateerror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-invalidstateerror-2">InvalidStateError</a></code>"
    <code><a href="#dfn-domexception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domexception-9">DOMException</a></code>.
  </li></ol>

  <p>Each of the following algorithms for <dfn id="dfn-producing-an-xml-serialization-of-a-dom-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">producing an XML serialization of a DOM node</dfn>
  take as input a <var>node</var> to serialize and the following arguments:
  </p><ul>
    <li>A <a href="#dfn-context-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-namespace-4">context namespace</a> <dfn id="dfn-namespace" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>namespace</var></dfn>
    </li><li>A <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-3">namespace prefix map</a> <dfn id="dfn-prefix-map" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>prefix map</var></dfn>
    </li><li>A <a href="#dfn-generated-namespace-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generated-namespace-prefix-index-3">generated namespace prefix index</a> <dfn id="dfn-prefix-index" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>prefix index</var></dfn>
    </li><li>The <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-5"><var>require well-formed</var></a> flag
  </li></ul>

  <p>The <dfn id="dfn-xml-serialization-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serialization algorithm</dfn>
  <a data-lt="producing an XML serialization of a DOM node" href="#dfn-producing-an-xml-serialization-of-a-dom-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-1">produces an XML serialization of an arbitrary DOM node</a>
  <var>node</var> based on the <var>node</var>'s interface type. Each referenced algorithm is
  to be passed the arguments as they were recieved by the caller and return their result to the
  caller. Re-throw any exceptions. If <var>node</var>'s interface is:</p>

  <dl class="switch">
    <dt><code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-14"><code>Element</code></a></code>
    </dt><dd>Run the algorithm for <a href="#dfn-xml-serializing-an-element-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serializing-an-element-node-1">XML serializing an Element node</a> <var>node</var>.

    </dd><dt><code><a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-6">Document</a></code>
    </dt><dd>Run the algorithm for <a href="#dfn-xml-serializing-a-document-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serializing-a-document-node-1">XML serializing a Document node</a> <var>node</var>.

    </dd><dt><code><a href="#dfn-comment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-comment-2">Comment</a></code>
    </dt><dd>Run the algorithm for <a href="#dfn-xml-serializing-a-comment-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serializing-a-comment-node-1">XML serializing a Comment node</a> <var>node</var>.

    

    </dd><dt><code><a href="#dfn-text" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-2">Text</a></code>
    </dt><dd>Run the algorithm for <a href="#dfn-xml-serializing-a-text-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serializing-a-text-node-1">XML serializing a Text node</a> <var>node</var>.

    </dd><dt><code><a href="#dfn-documentfragment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentfragment-5">DocumentFragment</a></code>
    </dt><dd>Run the algorithm for <a href="#dfn-xml-serializing-a-documentfragment-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serializing-a-documentfragment-node-1">XML serializing a DocumentFragment node</a> <var>node</var>.

    </dd><dt><code><a href="#dfn-documenttype" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documenttype-2">DocumentType</a></code>
    </dt><dd>Run the algorithm for <a href="#dfn-xml-serializing-a-documenttype-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serializing-a-documenttype-node-1">XML serializing a DocumentType node</a> <var>node</var>.

    </dd><dt><code><a href="#dfn-processinginstruction" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-processinginstruction-2">ProcessingInstruction</a></code>
    </dt><dd>Run the algorithm for <a href="#dfn-xml-serializing-a-processinginstruction-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serializing-a-processinginstruction-node-1">XML serializing a ProcessingInstruction node</a> <var>node</var>.

    </dd><dt>An <code><a href="#dfn-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attribute-5">Attr</a></code> object
    </dt><dd>Return an empty string.

    </dd><dt>Anything else
    </dt><dd>Throw a <a href="#dfn-typeerror" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-typeerror-2">TypeError</a>. Only <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-15">Node</a>s and <a href="#dfn-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attribute-6">Attr</a> objects can be serialized by
    this algorithm.
  </dd></dl>

  Each of the above referenced algorithms are detailed in the sections that follow.

<section id="xml-serializing-an-element-node"><div class="header-wrapper"><h5 id="x3-2-1-1-xml-serializing-an-element-node"><bdi class="secno">3.2.1.1 </bdi><dfn id="dfn-xml-serializing-an-element-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serializing an Element node</dfn></h5><a class="self-link" href="#xml-serializing-an-element-node" aria-label="Permalink for Section 3.2.1.1"></a></div>

  The algorithm for <a href="#dfn-producing-an-xml-serialization-of-a-dom-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-2">producing an XML serialization of a DOM node</a> of type <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-15"><code>Element</code></a> is as
  follows:

  <ol>
    <li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-6"><var>require well-formed</var></a> flag is set (its value is <code>true</code>),
    and this <var>node</var>'s <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-1">localName</a></code> attribute contains the character
    "<code>:</code>" (U+003A COLON) or does not match the XML <a href="#dfn-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-name-1">Name</a> production, then
    <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-1">throw an exception</a>; the serialization of this <var>node</var> would not be a well-formed
    element.

    </li><li>Let <var>markup</var> be the string "<code>&lt;</code>" (U+003C LESS-THAN SIGN).

    </li><li>Let <dfn id="dfn-qualified-name" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>qualified name</var></dfn> be an empty string.

    </li><li>Let <dfn id="dfn-skip-end-tag" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>skip end tag</var></dfn> be a boolean flag with value <code>false</code>.

    </li><li>Let <dfn id="dfn-ignore-namespace-definition-attribute" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>ignore namespace definition attribute</var></dfn> be a boolean flag with value
    <code>false</code>.

    </li><li>Given <a href="#dfn-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-map-4"><var>prefix map</var></a>, <a href="#dfn-copy-a-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-copy-a-namespace-prefix-map-1">copy a namespace prefix map</a> and let
    <var>map</var> be the result.

    </li><li>Let <dfn id="dfn-local-prefixes-map" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>local prefixes map</var></dfn> be an empty map. The map has unique <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-16">Node</a>
    <code>prefix</code> strings as its keys, with corresponding <code>namespaceURI</code>
    <a href="#dfn-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-node-17">Node</a> values as the map's key values (in this map, the <code>null</code> namespace is
    represented by the empty string).

    <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="6"><span>Note</span></div><p class="">This map is local to each element. It is used to ensure there are no conflicting
    prefixes should a new namespace <code>prefix</code> attribute need to be
    <a data-lt="generate a prefix" href="#dfn-generating-a-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generating-a-prefix-2">generated</a>. It is also used to enable skipping of duplicate
    prefix definitions when
    <a data-lt="XML serialization of the attributes" href="#dfn-xml-serialization-of-the-attributes" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-of-the-attributes-1">writing an element's attributes</a>: the map
    allows the algorithm to distinguish between a <code>prefix</code> in the
    <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-4">namespace prefix map</a> that might be locally-defined (to the current <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-16"><code>Element</code></a>) and
    one that is not.</p></div>

    </li><li>Let <dfn id="dfn-local-default-namespace" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>local default namespace</var></dfn> be the result of
    <a href="#dfn-recording-the-namespace-information" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-recording-the-namespace-information-1">recording the namespace information</a> for <var>node</var> given <var>map</var> and
    <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-1"><var>local prefixes map</var></a>.

    <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="6"><span>Note</span></div><p class="">The above step will update <var>map</var> with any found namespace prefix
    definitions, add the found prefix definitions to the <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-2"><var>local prefixes map</var></a> and
    return a <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-1"><var>local default namespace</var></a> value defined by a default namespace attribute if one
    exists. Otherwise it returns <code>null</code>.</p></div>

    </li><li>Let <dfn id="dfn-inherited-ns" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><var>inherited ns</var></dfn> be a copy of <a href="#dfn-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-3"><var>namespace</var></a>.

    </li><li>Let <var>ns</var> be the value of <var>node</var>'s
    <code><a data-lt="element namespaceURI" href="#dfn-namespaceuri" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespaceuri-1">namespaceURI</a></code> attribute.

    </li><li>If <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-1"><var>inherited ns</var></a> is equal to <var>ns</var>, then:
    <ol>
      <li>If <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-2"><var>local default namespace</var></a> is not <code>null</code>, then set
      <a href="#dfn-ignore-namespace-definition-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ignore-namespace-definition-attribute-1"><var>ignore namespace definition attribute</var></a> to <code>true</code>.

      </li><li>If <var>ns</var> is the <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-2">XML namespace</a>, then append to
      <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-1"><var>qualified name</var></a> the concatenation of the string "<code>xml:</code>" and the
      value of <var>node</var>'s <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-2">localName</a></code>.

      </li><li>Otherwise, append to <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-2"><var>qualified name</var></a> the value of <var>node</var>'s
      <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-3">localName</a></code>. <span class="note">The <var>node</var>'s
      <code><a data-lt="element prefix" href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-1">prefix</a></code> if it exists, is dropped.</span>

      </li><li>Append the value of <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-3"><var>qualified name</var></a> to <var>markup</var>.
    </li></ol>

    </li><li>Otherwise, <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-2"><var>inherited ns</var></a> is not equal to <var>ns</var> (the <var>node</var>'s
    own namespace is different from the context namespace of its parent). Run these sub-steps:
    
    <ol>
      <li>Let <var>prefix</var> be the value of <var>node</var>'s
      <code><a data-lt="element prefix" href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-2">prefix</a></code> attribute.

      </li><li>Let <var>candidate prefix</var> be the result of
      <a href="#dfn-retrieving-a-preferred-prefix-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-retrieving-a-preferred-prefix-string-1">retrieving a preferred prefix string</a> <var>prefix</var> from <var>map</var> given
      namespace <var>ns</var>.

      <div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="6"><span>Note</span></div><p class="">The above may return <code>null</code> if no namespace key <var>ns</var> exists
      in <var>map</var>.</p></div>

      </li><li>If the value of <var>prefix</var> matches "<code>xmlns</code>", then run the following
      steps:
      <ol>
        <li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-7"><var>require well-formed</var></a> flag is set, then throw an error. An
        <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-17"><code>Element</code></a> with <code><a data-lt="element prefix" href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-3">prefix</a></code> "<code>xmlns</code>"
        will not legally round-trip in a conforming <a href="#dfn-xml-parser" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-parser-1">XML parser</a>.

        </li><li>Let <var>candidate prefix</var> be the value of <var>prefix</var>.
      </li></ol>
      
      </li><li><dfn id="dfn-found-a-suitable-namespace-prefix" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Found a suitable namespace prefix</dfn>: if <var>candidate prefix</var> is not
      <code>null</code> (a namespace prefix is defined which maps to <var>ns</var>), then:

      <div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="6"><span>Note</span></div><p class="">The following may serialize a different
      <code><a data-lt="element prefix" href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-4">prefix</a></code> than the <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-18"><code>Element</code></a>'s existing
      <code><a data-lt="element prefix" href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-5">prefix</a></code> if it already had one. However, the
      <a href="#dfn-retrieving-a-preferred-prefix-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-retrieving-a-preferred-prefix-string-2">retrieving a preferred prefix string</a> algorithm already tried to match the existing
      prefix if possible.</p></div>

      <ol>
        <li>Append to <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-4"><var>qualified name</var></a> the concatenation of
        <var>candidate prefix</var>, "<code>:</code>" (U+003A COLON), and <var>node</var>'s <code>
        <a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-4">localName</a></code>. <span class="note">There exists on this <var>node</var> or the
        <var>node</var>'s ancestry a namespace prefix definition that defines the <var>node</var>'s
        namespace.</span>

        </li><li>If the <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-3"><var>local default namespace</var></a> is not <code>null</code> (there exists
        a locally-defined default namespace declaration attribute) and its value is not the
        <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-3">XML namespace</a>, then let <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-3"><var>inherited ns</var></a> get the value of
        <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-4"><var>local default namespace</var></a> unless the
        <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-5"><var>local default namespace</var></a> is the empty string in which case let it get
        <code>null</code> (the <a href="#dfn-context-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-namespace-5">context namespace</a> is changed to the declared default, rather
        than this <var>node</var>'s own namespace).

        <div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-5" aria-level="6"><span>Note</span></div><p class="">Any default namespace definitions or namespace prefixes that define the
        <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-4">XML namespace</a> are omitted when serializing this node's attributes.</p></div>

        </li><li>Append the value of <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-5"><var>qualified name</var></a> to <var>markup</var>.
      </li></ol>

      </li><li>Otherwise, if <var>prefix</var> is not <code>null</code>, then:

      <div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-6" aria-level="6"><span>Note</span></div><p class="">By this step, there is no namespace or prefix mapping declaration in this
      <var>node</var> (or any parent <var>node</var> visited by this algorithm) that defines
      <var>prefix</var> otherwise the step labelled <a href="#dfn-found-a-suitable-namespace-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-found-a-suitable-namespace-prefix-1">Found a suitable namespace prefix</a> would
      have been followed. The sub-steps that follow will create a new namespace prefix declaration
      for <var>prefix</var> and ensure that <var>prefix</var> does not conflict with an existing
      namespace prefix declaration of the same <code>localName</code> in <var>node</var>'s
      <a href="#dfn-attributes" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attributes-1">attribute list</a>.</p></div>

      <ol>
        <li>If the <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-3"><var>local prefixes map</var></a> contains a key matching <var>prefix</var>,
        then let <var>prefix</var> be the result of <a href="#dfn-generating-a-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generating-a-prefix-3">generating a prefix</a> providing as input
        <var>map</var>, <var>ns</var>, and <a href="#dfn-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-index-3">prefix index</a>.

        </li><li><a href="#dfn-add" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-add-2">Add</a> <var>prefix</var> to <var>map</var> given namespace <var>ns</var>.

        </li><li>Append to <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-6"><var>qualified name</var></a> the concatenation of <var>prefix</var>,
        "<code>:</code>" (U+003A COLON), and <var>node</var>'s <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-5">localName</a></code>.

        </li><li>Append the value of <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-7"><var>qualified name</var></a> to <var>markup</var>.

        </li><li>Append the following to <var>markup</var>, in the order listed:

        <div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-7" aria-level="6"><span>Note</span></div><p class="">The following serializes a namespace prefix declaration for <var>prefix</var>
        which was just added to the <var>map</var>.</p></div>

        <ol>
          <li>"<code> </code>" (U+0020 SPACE);

          </li><li>The string "<code>xmlns:</code>";

          </li><li>The value of <var>prefix</var>;

          </li><li>"<code>="</code>" (U+003D EQUALS SIGN, U+0022 QUOTATION MARK);

          </li><li>The result of <a href="#dfn-serializing-an-attribute-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-serializing-an-attribute-value-1">serializing an attribute value</a> given <var>ns</var> and the
          <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-8"><var>require well-formed</var></a> flag as input;

          </li><li>"<code>"</code>" (U+0022 QUOTATION MARK).

          </li><li>If <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-6"><var>local default namespace</var></a> is not <code>null</code> (there exists a
          locally-defined default namespace declaration attribute), then let
          <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-4"><var>inherited ns</var></a> get the value of <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-7"><var>local default namespace</var></a>
          unless the <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-8"><var>local default namespace</var></a> is the empty string in which case let
          it get <code>null</code>.
        </li></ol>
      </li></ol>

      </li><li>Otherwise, if <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-9"><var>local default namespace</var></a> is <code>null</code>, or
      <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-10"><var>local default namespace</var></a> is not <code>null</code> and its value is not equal
      to <var>ns</var>, then:

      <div class="note" role="note" id="issue-container-generatedID-8"><div role="heading" class="note-title marker" id="h-note-8" aria-level="6"><span>Note</span></div><p class="">At this point, the namespace for this node still needs to be serialized, but
      there's no <code>prefix</code> (or <var>candidate prefix</var>) availble; the following uses
      the default namespace declaration to define the namespace--optionally replacing an existing
      default declaration if present.</p></div>

      <ol>
        <li>Set the <a href="#dfn-ignore-namespace-definition-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ignore-namespace-definition-attribute-2"><var>ignore namespace definition attribute</var></a> flag to
        <code>true</code>.

        </li><li>Append to <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-8"><var>qualified name</var></a> the value of <var>node</var>'s
        <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-6">localName</a></code>.

        </li><li>Let the value of <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-5"><var>inherited ns</var></a> be <var>ns</var>.

        <div class="note" role="note" id="issue-container-generatedID-9"><div role="heading" class="note-title marker" id="h-note-9" aria-level="6"><span>Note</span></div><p class="">The new default namespace will be used in the serialization to define this
        <var>node</var>'s namespace and act as the <a href="#dfn-context-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-context-namespace-6">context namespace</a> for its
        <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-4">children</a>.</p></div>

        </li><li>Append the value of <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-9"><var>qualified name</var></a> to <var>markup</var>.

        </li><li>Append the following to <var>markup</var>, in the order listed:

        <div class="note" role="note" id="issue-container-generatedID-10"><div role="heading" class="note-title marker" id="h-note-10" aria-level="6"><span>Note</span></div><p class="">The following serializes the new (or replacement) default namespace
        definition.</p></div>

        <ol>
          <li>"<code> </code>" (U+0020 SPACE);

          </li><li>The string "<code>xmlns</code>";

          </li><li>"<code>="</code>" (U+003D EQUALS SIGN, U+0022 QUOTATION MARK);

          </li><li>The result of <a href="#dfn-serializing-an-attribute-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-serializing-an-attribute-value-2">serializing an attribute value</a> given <var>ns</var> and the
          <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-9"><var>require well-formed</var></a> flag as input;

          </li><li>"<code>"</code>" (U+0022 QUOTATION MARK).
        </li></ol>
      </li></ol>
      
      </li><li>Otherwise, the <var>node</var> has a <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-11"><var>local default namespace</var></a> that matches
      <var>ns</var>. Append to <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-10"><var>qualified name</var></a> the value of <var>node</var>'s
      <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-7">localName</a></code>, let the value of <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-6"><var>inherited ns</var></a> be <var>ns</var>,
      and append the value of <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-11"><var>qualified name</var></a> to <var>markup</var>.

      <div class="note" role="note" id="issue-container-generatedID-11"><div role="heading" class="note-title marker" id="h-note-11" aria-level="6"><span>Note</span></div><p class="">All of the combinations where <var>ns</var> is not equal to
      <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-7"><var>inherited ns</var></a> are handled above such that <var>node</var> will be serialized
      preserving its original <code><a data-lt="element namespaceURI" href="#dfn-namespaceuri" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespaceuri-2">namespaceURI</a></code>.</p></div>
    </li></ol>

    </li><li>Append to <var>markup</var> the result of the
    <a data-lt="XML serialization of the attributes" href="#dfn-xml-serialization-of-the-attributes" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-of-the-attributes-2">XML serialization of <var>node</var>'s attributes</a>
    given <var>map</var>, <a href="#dfn-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-index-4"><var>prefix index</var></a>, <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-4"><var>local prefixes map</var></a>,
    <a href="#dfn-ignore-namespace-definition-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ignore-namespace-definition-attribute-3"><var>ignore namespace definition attribute</var></a> flag, and
    <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-10"><var>require well-formed</var></a> flag.

    </li><li>If <var>ns</var> is the <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-8">HTML namespace</a>, and the <var>node</var>'s list of
    <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-5">children</a> is empty, and the <var>node</var>'s <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-8">localName</a></code> matches any
    one of the following <a href="#dfn-void-elements" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-void-elements-1">void elements</a>:
    "<code>area</code>",
    "<code>base</code>",
    "<code>basefont</code>",
    "<code>bgsound</code>",
    "<code>br</code>",
    "<code>col</code>",
    "<code>embed</code>",
    "<code>frame</code>",
    "<code>hr</code>",
    "<code>img</code>",
    "<code>input</code>",
    "<code>keygen</code>",
    "<code>link</code>",
    "<code>menuitem</code>",
    "<code>meta</code>",
    "<code>param</code>",
    "<code>source</code>",
    "<code>track</code>",
    "<code>wbr</code>";
    then append the following to <var>markup</var>, in the order listed:
    <ol>
      <li>"<code> </code>" (U+0020 SPACE);

      </li><li>"<code>/</code>" (U+002F SOLIDUS).
    </li></ol>
    and set the <a href="#dfn-skip-end-tag" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-skip-end-tag-1"><var>skip end tag</var></a> flag to <code>true</code>.

    </li><li>If <var>ns</var> is not the <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-9">HTML namespace</a>, and the <var>node</var>'s list of
    <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-6">children</a> is empty, then append "<code>/</code>" (U+002F SOLIDUS) to <var>markup</var>
    and set the <a href="#dfn-skip-end-tag" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-skip-end-tag-2"><var>skip end tag</var></a> flag to <code>true</code>.

    </li><li>Append "<code>&gt;</code>" (U+003E GREATER-THAN SIGN) to <var>markup</var>.

    </li><li>If the value of <a href="#dfn-skip-end-tag" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-skip-end-tag-3"><var>skip end tag</var></a> is <code>true</code>, then return the value of
    <var>markup</var> and skip the remaining steps. The <var>node</var> is a leaf-node.

    </li><li>If <var>ns</var> is the <a href="#dfn-html-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-namespace-10">HTML namespace</a>, and the <var>node</var>'s
    <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-9">localName</a></code> matches the string "<code>template</code>", then this is a
    <code><a href="#dfn-template" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-5">template</a></code> element. Append to <var>markup</var> the result of
    <a href="#dfn-xml-serializing-a-documentfragment-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serializing-a-documentfragment-node-2">XML serializing a DocumentFragment node</a> given the <a href="#dfn-template" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-6">template</a> element's
    <a href="#dfn-template-content" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-content-2">template contents</a> (a <code><a href="#dfn-documentfragment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentfragment-6">DocumentFragment</a></code>), providing
    <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-8"><var>inherited ns</var></a>, <var>map</var>, <a href="#dfn-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-index-5"><var>prefix index</var></a>, and the
    <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-11"><var>require well-formed</var></a> flag.

    <div class="note" role="note" id="issue-container-generatedID-12"><div role="heading" class="note-title marker" id="h-note-12" aria-level="6"><span>Note</span></div><p class="">This allows <a href="#dfn-template-content" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-content-3">template content</a> to round-trip , given the rules for
    <a href="#dfn-parsing-xhtml-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-parsing-xhtml-documents-1">parsing XHTML documents</a>.</p></div>

    </li><li>Otherwise, append to <var>markup</var> the result of running the
    <a href="#dfn-xml-serialization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-algorithm-3">XML serialization algorithm</a> on each of <var>node</var>'s <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-7">children</a>, in
    <a href="#dfn-tree-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-tree-order-1">tree order</a>, providing <a href="#dfn-inherited-ns" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-inherited-ns-9"><var>inherited ns</var></a>, <var>map</var>,
    <a href="#dfn-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-index-6"><var>prefix index</var></a>, and the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-12"><var>require well-formed</var></a> flag.

    </li><li>Append the following to <var>markup</var>, in the order listed:
    <ol>
      <li>"<code>&lt;/</code>" (U+003C LESS-THAN SIGN, U+002F SOLIDUS);

      </li><li>The value of <a href="#dfn-qualified-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-qualified-name-12"><var>qualified name</var></a>;

      </li><li>"<code>&gt;</code>" (U+003E GREATER-THAN SIGN).
    </li></ol>

    </li><li>Return the value of <var>markup</var>.
  </li></ol>

<section id="recording-the-namespace"><div class="header-wrapper"><h6 id="x3-2-1-1-1-recording-the-namespace"><bdi class="secno">3.2.1.1.1 </bdi>Recording the namespace</h6><a class="self-link" href="#recording-the-namespace" aria-label="Permalink for Section 3.2.1.1.1"></a></div>

  <p>This following algorithm will update the <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-5">namespace prefix map</a> with any found namespace
  prefix definitions, add the found prefix definitions to the <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-5"><var>local prefixes map</var></a>,
  and return a <a href="#dfn-local-default-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-default-namespace-12"><var>local default namespace</var></a> value defined by a default namespace attribute if one
  exists. Otherwise it returns <code>null</code>.</p>

  <p>When <dfn id="dfn-recording-the-namespace-information" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">recording the namespace information</dfn> for an <code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-19"><code>Element</code></a></code>
  <var>element</var>, given a <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-6">namespace prefix map</a> <var>map</var> and a
  <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-6"><var>local prefixes map</var></a> (initially empty), the user agent must run the following
  steps:

  </p><ol>
    <li>Let <var>default namespace attr value</var> be <code>null</code>.

    </li><li><dfn id="dfn-main" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Main</dfn>: For each <a href="#dfn-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attribute-7">attribute</a> <var>attr</var> in <var>element</var>'s
    <code><a href="#dfn-attributes" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attributes-2">attributes</a></code>, in the order they are specified in the <var>element</var>'s
    <a href="#dfn-attributes" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attributes-3">attribute list</a>:

    <div class="note" role="note" id="issue-container-generatedID-13"><div role="heading" class="note-title marker" id="h-note-13" aria-level="7"><span>Note</span></div><p class="">The following conditional steps find namespace prefixes. Only attributes
    in the <a href="#dfn-xmlns-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xmlns-namespace-1">XMLNS namespace</a> are considered (e.g., attributes made to look like namespace
    declarations via <code><a href="#dfn-setattribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-setattribute-1">setAttribute</a>(<em>"xmlns:pretend-prefix"</em>,
    <em>"pretend-namespace"</em>)</code> are not included).</p></div>

    <ol>
      <li>Let <var>attribute namespace</var> be the value of <var>attr</var>'s
      <code><a href="#dfn-namespaceuri" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespaceuri-3">namespaceURI</a></code> value.

      </li><li>Let <var>attribute prefix</var> be the value of <var>attr</var>'s
      <code><a href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-6">prefix</a></code>.

      </li><li>If the <var>attribute namespace</var> is the <a href="#dfn-xmlns-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xmlns-namespace-2">XMLNS namespace</a>, then:
      <ol>
        <li>If <var>attribute prefix</var> is <code>null</code>, then <var>attr</var> is a default
        namespace declaration. Set the <var>default namespace attr value</var> to <var>attr</var>'s
        <code><a href="#dfn-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-value-1">value</a></code> and stop running these steps, returning to <a href="#dfn-main" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-main-1">Main</a> to visit
        the next attribute.

        </li><li>Otherwise, the <var>attribute prefix</var> is not <code>null</code> and <var>attr</var>
        is a namespace prefix definition. Run the following steps:
        <ol>
          <li>Let <var>prefix definition</var> be the value of <var>attr</var>'s
          <code><a data-lt="attr localName" href="#dfn-attr-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attr-localname-1">localName</a></code>.

          </li><li>Let <var>namespace definition</var> be the value of <var>attr</var>'s
          <code><a href="#dfn-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-value-2">value</a></code>.

          </li><li>If <var>namespace definition</var> is the <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-5">XML namespace</a>, then stop running
          these steps, and return to <a href="#dfn-main" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-main-2">Main</a> to visit the next attribute.

          <div class="note" role="note" id="issue-container-generatedID-14"><div role="heading" class="note-title marker" id="h-note-14" aria-level="7"><span>Note</span></div><p class=""><a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-6">XML namespace</a> definitions in prefixes are completely ignored (in
          order to avoid unnecessary work when there might be prefix conflicts).
          <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-7">XML namespace</a>d elements are always handled uniformly by prefixing (and overriding
          if necessary) the element's localname with the reserved "<code>xml</code>" prefix.</p></div>

          </li><li>If <var>namespace definition</var> is the empty string (the declarative form of
          having no namespace), then let <var>namespace definition</var> be <code>null</code>
          instead.

          </li><li>If <var>prefix definition</var> is <a href="#dfn-found" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-found-1">found</a> in <var>map</var> given the namespace
          <var>namespace definition</var>, then stop running these steps, and return to <a href="#dfn-main" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-main-3">Main</a>
          to visit the next attribute.

          <div class="note" role="note" id="issue-container-generatedID-15"><div role="heading" class="note-title marker" id="h-note-15" aria-level="7"><span>Note</span></div><p class="">This step avoids adding duplicate prefix definitions for the same namespace
          in the <var>map</var>. This has the side-effect of avoiding later serialization of
          duplicate namespace prefix declarations in any descendant nodes.</p></div>

          </li><li><a href="#dfn-add" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-add-3">Add</a> the prefix <var>prefix definition</var> to <var>map</var> given namespace
          <var>namespace definition</var>.

          </li><li>Add the value of <var>prefix definition</var> as a new key to the
          <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-7"><var>local prefixes map</var></a>, with the <var>namespace definition</var> as the
          key's value replacing the value of <code>null</code> with the empty string if applicable.
        </li></ol>
      </li></ol>
    </li></ol>
    </li><li>Return the value of <var>default namespace attr value</var>.

    <div class="note" role="note" id="issue-container-generatedID-16"><div role="heading" class="note-title marker" id="h-note-16" aria-level="7"><span>Note</span></div><p class="">The empty string is a legitimate return value and is not converted to
    <code>null</code>.</p></div>
  </li></ol>

</section>

<section id="the-namespace-prefix-map"><div class="header-wrapper"><h6 id="x3-2-1-1-2-the-namespace-prefix-map"><bdi class="secno">3.2.1.1.2 </bdi>The Namespace Prefix Map</h6><a class="self-link" href="#the-namespace-prefix-map" aria-label="Permalink for Section 3.2.1.1.2"></a></div>

  <p>A <dfn id="dfn-namespace-prefix-map" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">namespace prefix map</dfn> is a map that associates <code>namespaceURI</code> and
  <dfn data-lt="list|namespace prefix lists" data-plurals="namespace prefix list" id="dfn-list" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">namespace prefix lists</dfn>, where <code>namespaceURI</code> values are the
  map's unique keys (which can include the <code>null</code> value representing no namespace), and
  ordered lists of associated <code>prefix</code> values are the map's key values. The
  <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-7">namespace prefix map</a> will be populated by previously seen namespaceURIs and all their
  previously encountered prefix associations for a given node and its ancestors.

  </p><div class="note" role="note" id="issue-container-generatedID-17"><div role="heading" class="note-title marker" id="h-note-17" aria-level="7"><span>Note</span></div><p class=""><strong>Note:</strong> the last seen <code>prefix</code> for a given
  <code>namespaceURI</code> is at the end of its respective <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-1">list</a>. The list is searched to
  find potentially matching prefixes, and if no matches are found for the given
  <code>namespaceURI</code>, then the last <code>prefix</code> in the list is used. See
  <a href="#dfn-copy-a-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-copy-a-namespace-prefix-map-2">copy a namespace prefix map</a> and <a href="#dfn-retrieving-a-preferred-prefix-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-retrieving-a-preferred-prefix-string-3">retrieve a preferred prefix string</a> for additional
  details.</p></div>

  <p>To <dfn id="dfn-copy-a-namespace-prefix-map" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">copy a namespace prefix map</dfn> <var>map</var> means to copy the <var>map</var>'s
  keys into a new empty <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-8">namespace prefix map</a>, and to copy each of the values in the
  <a data-lt="list" href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-2">namespace prefix list</a> associated with each keys' value into a new
  <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-3">list</a> which should be associated with the respective key in the new map.

  </p><p>To <dfn data-lt="retrieving a preferred prefix string|retrieve a preferred prefix string" id="dfn-retrieving-a-preferred-prefix-string" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">retrieve a preferred prefix string</dfn>
  <var>preferred prefix</var> from the <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-9">namespace prefix map</a> <var>map</var> given a namespace
  <var>ns</var>, the user agent should:

  </p><ol>
    <li>Let <var>candidates list</var> be the result of retrieving a <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-4">list</a> from <var>map</var>
    where there exists a key in <var>map</var> that matches the value of <var>ns</var> or if there
    is no such key, then stop running these steps, and return the <code>null</code> value.

    </li><li>Otherwise, for each prefix value <var>prefix</var> in <var>candidates list</var>, iterating
    from beginning to end:

    <div class="note" role="note" id="issue-container-generatedID-18"><div role="heading" class="note-title marker" id="h-note-18" aria-level="7"><span>Note</span></div><p class="">There will always be at least one prefix value in the list.</p></div>

    <ol>
      <li>If <var>prefix</var> matches <var>preferred prefix</var>, then stop running these steps
      and return <var>prefix</var>.

      </li><li>If <var>prefix</var> is the last item in the <var>candidates list</var>, then stop running
      these steps and return <var>prefix</var>.
    </li></ol>
  </li></ol>

  <p>To check if a prefix string <var>prefix</var> is <dfn id="dfn-found" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">found</dfn> in a
  <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-10">namespace prefix map</a> <var>map</var> given a namespace <var>ns</var>, the user agent should:

  </p><ol>
    <li>Let <var>candidates list</var> be the result of retrieving a <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-5">list</a> from <var>map</var>
    where there exists a key in <var>map</var> that matches the value of <var>ns</var> or if there
    is no such key, then stop running these steps, and return <code>false</code>.

    </li><li>If the value of <var>prefix</var> occurs at least once in <var>candidates list</var>, return
    <code>true</code>, otherwise return <code>false</code>.
  </li></ol>

  <p>To <dfn id="dfn-add" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">add</dfn> a prefix string <var>prefix</var> to the <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-11">namespace prefix map</a>
  <var>map</var> given a namespace <var>ns</var>, the user agent should:

  </p><ol>
    <li>Let <var>candidates list</var> be the result of retrieving a <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-6">list</a> from <var>map</var>
    where there exists a key in <var>map</var> that matches the value of <var>ns</var> or if there
    is no such key, then let <var>candidates list</var> be <code>null</code>.

    </li><li>If <var>candidates list</var> is <code>null</code>, then create a new <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-7">list</a> with
    <var>prefix</var> as the only item in the <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-8">list</a>, and associate that <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-9">list</a> with a new
    key <var>ns</var> in <var>map</var>.

    </li><li>Otherwise, append <var>prefix</var> to the end of <var>candidates list</var>.

    <div class="note" role="note" id="issue-container-generatedID-19"><div role="heading" class="note-title marker" id="h-note-19" aria-level="7"><span>Note</span></div><p class="">The steps in <a href="#dfn-retrieving-a-preferred-prefix-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-retrieving-a-preferred-prefix-string-4">retrieve a preferred prefix string</a> use the <a href="#dfn-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-list-10">list</a> to
    track the most recently used (MRU) <var>prefix</var> associated with a given namespace, which
    will be the <var>prefix</var> at the end of the list. This list may contain duplicates of the
    same <var>prefix</var> value seen earlier (and that's OK).</p></div>
  </li></ol>

</section>

<section id="serializing-an-element-s-attributes"><div class="header-wrapper"><h6 id="x3-2-1-1-3-serializing-an-element-s-attributes"><bdi class="secno">3.2.1.1.3 </bdi>Serializing an Element's attributes</h6><a class="self-link" href="#serializing-an-element-s-attributes" aria-label="Permalink for Section 3.2.1.1.3"></a></div>

  <p>The <dfn id="dfn-xml-serialization-of-the-attributes" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serialization of the attributes</dfn> of an <code><a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-20"><code>Element</code></a></code>
  <var>element</var> together with a <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-12">namespace prefix map</a> <var>map</var>, a
  <a href="#dfn-generated-namespace-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generated-namespace-prefix-index-4">generated namespace prefix index</a> <var>prefix index</var> reference, a
  <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-8">local prefixes map</a>, a <a href="#dfn-ignore-namespace-definition-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ignore-namespace-definition-attribute-4"><var>ignore namespace definition attribute</var></a> flag, and a
  <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-13"><var>require well-formed</var></a> flag, is the result of the following algorithm:

  </p><ol>
    <li>Let <var>result</var> be the empty string.

    </li><li>Let <var>localname set</var> be a new empty <var>namespace localname set</var>. This
    <var>localname set</var> will contain tuples of unique attribute
    <code><a href="#dfn-namespaceuri" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespaceuri-4">namespaceURI</a></code> and <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-10">localName</a></code> pairs, and is populated as
    each <var>attr</var> is processed. <span class="note">This set is used to [optionally] enforce
    the well-formed constraint that an element cannot have two attributes with the same
    <code><a href="#dfn-namespaceuri" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespaceuri-5">namespaceURI</a></code> and <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-11">localName</a></code>. This can occur when two
    otherwise identical attributes on the same element differ only by their prefix values.</span>

    </li><li><dfn id="dfn-loop" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Loop</dfn>: For each <a href="#dfn-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attribute-8">attribute</a> <var>attr</var> in <var>element</var>'s
    <code><a href="#dfn-attributes" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attributes-4">attributes</a></code>, in the order they are specified in the <var>element</var>'s
    <a href="#dfn-attributes" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attributes-5">attribute list</a>:
    <ol>
      <li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-14"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and the
      <var>localname set</var> contains a tuple whose values match those of a new tuple consisting
      of <var>attr</var>'s <code><a href="#dfn-namespaceuri" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespaceuri-6">namespaceURI</a></code> attribute and
      <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-12">localName</a></code> attribute, then <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-2">throw an exception</a>; the serialization of
      this <var>attr</var> would fail to produce a well-formed element serialization.

      </li><li>Create a new tuple consisting of <var>attr</var>'s <code><a href="#dfn-namespaceuri" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespaceuri-7">namespaceURI</a></code>
      attribute and <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-13">localName</a></code> attribute, and add it to the
      <var>localname set</var>.

      </li><li>Let <var>attribute namespace</var> be the value of <var>attr</var>'s
      <code><a href="#dfn-namespaceuri" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespaceuri-8">namespaceURI</a></code> value.

      
      </li><li>Let <var>candidate prefix</var> be <code>null</code>.

      </li><li>If <var>attribute namespace</var> is not <code>null</code>, then run these sub-steps:
      <ol>
        <li>Let <var>candidate prefix</var> be the result of
        <a href="#dfn-retrieving-a-preferred-prefix-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-retrieving-a-preferred-prefix-string-5">retrieving a preferred prefix string</a> from <var>map</var> given namespace
        <var>attribute namespace</var> with preferred prefix being <var>attr</var>'s
        <code><a href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-7">prefix</a></code> value.

        </li><li>If the value of <var>attribute namespace</var> is the <a href="#dfn-xmlns-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xmlns-namespace-3">XMLNS namespace</a>, then run
        these steps:
        <ol>
          <li>If any of the following are true, then stop running these steps and goto <a href="#dfn-loop" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-loop-1">Loop</a>
          to visit the next attribute:
          <ul>
            <li>the <var>attr</var>'s <code><a href="#dfn-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-value-3">value</a></code> is the <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-8">XML namespace</a>;

            <div class="note" role="note" id="issue-container-generatedID-20"><div role="heading" class="note-title marker" id="h-note-20" aria-level="7"><span>Note</span></div><p class="">The <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-9">XML namespace</a> cannot be redeclared and survive
            <a href="#dfn-round-tripping" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-round-tripping-3">round-tripping</a> (unless it defines the prefix "<code>xml</code>"). To avoid this
            problem, this algorithm always prefixes elements in the <a href="#dfn-xml-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-namespace-10">XML namespace</a> with
            "<code>xml</code>" and drops any related definitions as seen in the above condition.</p></div>

            </li><li>the <var>attr</var>'s <code><a href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-8">prefix</a></code> is <code>null</code> and the
            <a href="#dfn-ignore-namespace-definition-attribute" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ignore-namespace-definition-attribute-5"><var>ignore namespace definition attribute</var></a> flag is <code>true</code> (the
            <a href="#dom-element" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-21"><code>Element</code></a>'s default namespace attribute should be skipped);

            </li><li>the <var>attr</var>'s <code><a href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-9">prefix</a></code> is not <code>null</code> and either
            <ul>
              <li>the <var>attr</var>'s <code><a data-lt="attr localName" href="#dfn-attr-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attr-localname-2">localName</a></code> is
              not a key contained in the <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-9">local prefixes map</a>, or

              </li><li>the <var>attr</var>'s <code><a data-lt="attr localName" href="#dfn-attr-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attr-localname-3">localName</a></code> is
               present in the <a href="#dfn-local-prefixes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-local-prefixes-map-10">local prefixes map</a> but the value of the key does not match
               <var>attr</var>'s <code><a href="#dfn-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-value-4">value</a></code>
            </li></ul>
            and furthermore that the <var>attr</var>'s
            <code><a data-lt="attr localName" href="#dfn-attr-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attr-localname-4">localName</a></code> (as the <var>prefix</var> to
            find) is <a href="#dfn-found" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-found-2">found</a> in the <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-13">namespace prefix map</a> given the namespace consisting
            of the <var>attr</var>'s <code><a href="#dfn-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-value-5">value</a></code> (the current namespace prefix
            definition was exactly defined previously--on an ancestor element not the current
            element whose attributes are being processed).
          </li></ul>

          </li><li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-15"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and
          the value of <var>attr</var>'s <code><a href="#dfn-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-value-6">value</a></code> attribute matches the
          <a href="#dfn-xmlns-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xmlns-namespace-4">XMLNS namespace</a>, then throw an exception; the serialization of this attribute would
          produce invalid XML because the <a href="#dfn-xmlns-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xmlns-namespace-5">XMLNS namespace</a> is reserved and cannot be applied
          as an element's namespace via XML parsing.

          <div class="note" role="note" id="issue-container-generatedID-21"><div role="heading" class="note-title marker" id="h-note-21" aria-level="7"><span>Note</span></div><p class="">DOM APIs do allow creation of elements in the <a href="#dfn-xmlns-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xmlns-namespace-6">XMLNS namespace</a> but
          with strict qualifications.</p></div>

          </li><li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-16"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and
          the value of <var>attr</var>'s <code><a href="#dfn-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-value-7">value</a></code> attribute is the empty string,
          then throw an exception; namespace prefix declarations cannot be used to undeclare a
          namespace (use a default namespace declaration instead).

          </li><li>the <var>attr</var>'s <code><a href="#dfn-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-10">prefix</a></code> matches the string
          "<code>xmlns</code>", then let <var>candidate prefix</var> be the string
          "<code>xmlns</code>".
        </li></ol>

        </li><li>Otherwise, the <var>attribute namespace</var> in not the <a href="#dfn-xmlns-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xmlns-namespace-7">XMLNS namespace</a>. Run
        these steps:
        <ol>
          <li>Let <var>candidate prefix</var> be the result of <a href="#dfn-generating-a-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generating-a-prefix-4">generating a prefix</a> providing
          <var>map</var>, <var>attribute namespace</var>, and <var>prefix index</var> as input.

          </li><li>Append the following to <var>result</var>, in the order listed:
          <ol>
            <li>"<code> </code>" (U+0020 SPACE);

            </li><li>The string "<code>xmlns:</code>";

            </li><li>The value of <var>candidate prefix</var>;

            </li><li>"<code>="</code>" (U+003D EQUALS SIGN, U+0022 QUOTATION MARK);

            </li><li>The result of <a href="#dfn-serializing-an-attribute-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-serializing-an-attribute-value-3">serializing an attribute value</a> given <var>attribute namespace</var>
            and the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-17"><var>require well-formed</var></a> flag as input;

            </li><li>"<code>"</code>" (U+0022 QUOTATION MARK).
          </li></ol>
        </li></ol>
      </li></ol>
      
      </li><li>Append a "<code> </code>" (U+0020 SPACE) to <var>result</var>.

      </li><li>If <var>candidate prefix</var> is not <code>null</code>, then append to <var>result</var>
      the concatenation of <var>candidate prefix</var> with "<code>:</code>" (U+003A COLON).

      </li><li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-18"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and this
      <var>attr</var>'s <code><a href="#dfn-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-localname-14">localName</a></code> attribute contains the character
      "<code>:</code>" (U+003A COLON) or does not match the XML <a href="#dfn-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-name-2">Name</a> production or equals
      "<code>xmlns</code>" and <var>attribute namespace</var> is <code>null</code>, then
      <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-3">throw an exception</a>; the serialization of this <var>attr</var> would not be a
      well-formed attribute.

      </li><li>Append the following strings to <var>result</var>, in the order listed:
      <ol>
        <li>The value of <var>attr</var>'s <code><a data-lt="attr localName" href="#dfn-attr-localname" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attr-localname-5">localName</a></code>;

        </li><li>"<code>="</code>" (U+003D EQUALS SIGN, U+0022 QUOTATION MARK);

        </li><li>The result of <a href="#dfn-serializing-an-attribute-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-serializing-an-attribute-value-4">serializing an attribute value</a> given <var>attr</var>'s
        <code><a href="#dfn-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-value-8">value</a></code> attribute and the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-19"><var>require well-formed</var></a> flag as input;

        </li><li>"<code>"</code>" (U+0022 QUOTATION MARK).
      </li></ol>
    </li></ol>
    </li><li>Return the value of <var>result</var>.
  </li></ol>

  <p>When <dfn id="dfn-serializing-an-attribute-value" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">serializing an attribute value</dfn> given an <var>attribute value</var> and
  <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-20"><var>require well-formed</var></a> flag, the user agent must run the following steps:

  </p><ol>
    <li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-21"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and
    <var>attribute value</var> contains characters that are not matched by the XML <a href="#dfn-char" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-char-1">Char</a>
    production, then <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-4">throw an exception</a>; the serialization of this <var>attribute value</var>
    would fail to produce a well-formed element serialization.

    </li><li>If <var>attribute value</var> is <code>null</code>, then return the empty string.

    </li><li>Otherwise, <var>attribute value</var> is a string. Return the value of
    <var>attribute value</var>, first replacing any occurrences of the following:
    <ol>
      <li>"<code>&amp;</code>" with "<code>&amp;amp;</code>"

      </li><li>"<code>"</code>" with "<code>&amp;quot;</code>"

      </li><li>"<code>&lt;</code>" with "<code>&amp;lt;</code>"

      </li><li>"<code>&gt;</code>" with "<code>&amp;gt;</code>"
    </li></ol>
    <div class="note" role="note" id="issue-container-generatedID-22"><div role="heading" class="note-title marker" id="h-note-22" aria-level="7"><span>Note</span></div><p class="">This matches behavior present in browsers, and goes above and beyond the grammar
    requirement in the XML specification's <a href="#dfn-attvalue" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-attvalue-1">AttValue</a> production by also replacing
    "<code>&gt;</code>" characters.</p></div>
  </li></ol>

</section>

<section id="generating-namespace-prefixes"><div class="header-wrapper"><h6 id="x3-2-1-1-4-generating-namespace-prefixes"><bdi class="secno">3.2.1.1.4 </bdi>Generating namespace prefixes</h6><a class="self-link" href="#generating-namespace-prefixes" aria-label="Permalink for Section 3.2.1.1.4"></a></div>

  <p>To <dfn data-lt="generating a prefix|generate a prefix" id="dfn-generating-a-prefix" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">generate a prefix</dfn> given a
  <a href="#dfn-namespace-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-prefix-map-14">namespace prefix map</a> <var>map</var>, a string <var>new namespace</var>, and a reference to
  a <a href="#dfn-generated-namespace-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-generated-namespace-prefix-index-5">generated namespace prefix index</a> <var>prefix index</var>, the user agent must run the
  following steps:
  </p><ol>
    <li>Let <var>generated prefix</var> be the concatenation of the string "<code>ns</code>" and the
    current numerical value of <var>prefix index</var>.

    </li><li>Let the value of <var>prefix index</var> be incremented by one.

    </li><li><a href="#dfn-add" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-add-4">Add</a> to <var>map</var> the <var>generated prefix</var> given the
    <var>new namespace</var> namespace.

    </li><li>Return the value of <var>generated prefix</var>.
  </li></ol>

</section>

</section>

<section id="xml-serializing-a-document-node"><div class="header-wrapper"><h5 id="x3-2-1-2-xml-serializing-a-document-node"><bdi class="secno">3.2.1.2 </bdi><dfn id="dfn-xml-serializing-a-document-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serializing a Document node</dfn></h5><a class="self-link" href="#xml-serializing-a-document-node" aria-label="Permalink for Section 3.2.1.2"></a></div>

  The algorithm for <a href="#dfn-producing-an-xml-serialization-of-a-dom-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-3">producing an XML serialization of a DOM node</a> of type <a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-7">Document</a> is
  as follows:

  <p>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-22"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and this
  <var>node</var> has no <code><a href="#dfn-documentelement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentelement-1">documentElement</a></code> (the
  <code><a href="#dfn-documentelement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentelement-2">documentElement</a></code> attribute's value is <code>null</code>), then
  <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-5">throw an exception</a>; the serialization of this <var>node</var> would not be a well-formed
  document.

  </p><p>Otherwise, run the following steps:
  </p><ol>
    <li>Let <var>serialized document</var> be an empty string.

    </li><li>For each <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-8">child</a> <var>child</var> of <var>node</var>, in <a href="#dfn-tree-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-tree-order-2">tree order</a>, run the
    <a href="#dfn-xml-serialization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-algorithm-4">XML serialization algorithm</a> on the <var>child</var> passing along the provided arguments,
    and append the result to <var>serialized document</var>.

    <div class="note" role="note" id="issue-container-generatedID-23"><div role="heading" class="note-title marker" id="h-note-23" aria-level="6"><span>Note</span></div><p class="">This will serialize any number of <a href="#dfn-processinginstruction" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-processinginstruction-3">ProcessingInstruction</a> and <a href="#dfn-comment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-comment-3">Comment</a>
    nodes both before and after the <a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-8">Document</a>'s <a href="#dfn-documentelement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentelement-3">documentElement</a> node, including
    at most one <a href="#dfn-documenttype" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documenttype-3">DocumentType</a> node. (<a href="#dfn-text" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-3">Text</a> nodes are not allowed as children of the
    <a href="#dfn-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-document-9">Document</a>.)</p></div>

    </li><li>Return the value of <var>serialized document</var>.
  </li></ol>

</section>

<section id="xml-serializing-a-comment-node"><div class="header-wrapper"><h5 id="x3-2-1-3-xml-serializing-a-comment-node"><bdi class="secno">3.2.1.3 </bdi><dfn id="dfn-xml-serializing-a-comment-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serializing a Comment node</dfn></h5><a class="self-link" href="#xml-serializing-a-comment-node" aria-label="Permalink for Section 3.2.1.3"></a></div>

  The algorithm for <a href="#dfn-producing-an-xml-serialization-of-a-dom-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-4">producing an XML serialization of a DOM node</a> of type <a href="#dfn-comment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-comment-4">Comment</a> is as
  follows:

  <p>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-23"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and
  <var>node</var>'s <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-1">data</a></code> contains characters that are not matched by the XML
  <a href="#dfn-char" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-char-2">Char</a> production or contains "<code>--</code>" (two adjacent U+002D HYPHEN-MINUS
  characters) or that ends with a "<code>-</code>" (U+002D HYPHEN-MINUS) character, then
  <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-6">throw an exception</a>; the serialization of this <var>node</var>'s <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-2">data</a></code>
  would not be well-formed.

  </p><p>Otherwise, return the concatenation of "<code>&lt;!--</code>", <var>node</var>'s
  <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-3">data</a></code>, and "<code>--&gt;</code>".

</p></section>



<section id="xml-serializing-a-text-node"><div class="header-wrapper"><h5 id="x3-2-1-4-xml-serializing-a-text-node"><bdi class="secno">3.2.1.4 </bdi><dfn id="dfn-xml-serializing-a-text-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serializing a Text node</dfn></h5><a class="self-link" href="#xml-serializing-a-text-node" aria-label="Permalink for Section 3.2.1.4"></a></div>

  The algorithm for <a href="#dfn-producing-an-xml-serialization-of-a-dom-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-5">producing an XML serialization of a DOM node</a> of type <a href="#dfn-text" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-4">Text</a> is as
  follows:

  <ol>
    <li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-24"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and
    <var>node</var>'s <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-4">data</a></code> contains characters that are not matched by the XML
    <a href="#dfn-char" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-char-3">Char</a> production, then <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-7">throw an exception</a>; the serialization of this
    <var>node</var>'s <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-5">data</a></code> would not be well-formed.

    </li><li>Let <var>markup</var> be the value of <var>node</var>'s <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-6">data</a></code>.

    </li><li>Replace any occurrences of "<code>&amp;</code>" in <var>markup</var> by
    "<code>&amp;amp;</code>".

    </li><li>Replace any occurrences of "<code>&lt;</code>" in <var>markup</var> by
    "<code>&amp;lt;</code>".

    </li><li>Replace any occurrences of "<code>&gt;</code>" in <var>markup</var> by
    "<code>&amp;gt;</code>".

    </li><li>Return the value of <var>markup</var>.
  </li></ol>

</section>

<section id="xml-serializing-a-documentfragment-node"><div class="header-wrapper"><h5 id="x3-2-1-5-xml-serializing-a-documentfragment-node"><bdi class="secno">3.2.1.5 </bdi><dfn id="dfn-xml-serializing-a-documentfragment-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serializing a DocumentFragment node</dfn></h5><a class="self-link" href="#xml-serializing-a-documentfragment-node" aria-label="Permalink for Section 3.2.1.5"></a></div>

  The algorithm for <a href="#dfn-producing-an-xml-serialization-of-a-dom-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-6">producing an XML serialization of a DOM node</a> of type
  <a href="#dfn-documentfragment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documentfragment-7">DocumentFragment</a> is as follows:

  <ol>
    <li>Let <var>markup</var> the empty string.

    </li><li>For each <a href="#dfn-child" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-child-9">child</a> <var>child</var> of <var>node</var>, in <a href="#dfn-tree-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-tree-order-3">tree order</a>, run the
    <a href="#dfn-xml-serialization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-xml-serialization-algorithm-5">XML serialization algorithm</a> on the <var>child</var> given <a href="#dfn-namespace" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-namespace-4"><var>namespace</var></a>,
    <a href="#dfn-prefix-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-map-5"><var>prefix map</var></a>, a reference to <a href="#dfn-prefix-index" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prefix-index-7"><var>prefix index</var></a>, and flag
    <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-25"><var>require well-formed</var></a>. Concatenate the result to <var>markup</var>.

    </li><li>Return the value of <var>markup</var>.
  </li></ol>

</section>

<section id="xml-serializing-a-documenttype-node"><div class="header-wrapper"><h5 id="x3-2-1-6-xml-serializing-a-documenttype-node"><bdi class="secno">3.2.1.6 </bdi><dfn id="dfn-xml-serializing-a-documenttype-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serializing a DocumentType node</dfn></h5><a class="self-link" href="#xml-serializing-a-documenttype-node" aria-label="Permalink for Section 3.2.1.6"></a></div>

  The algorithm for <a href="#dfn-producing-an-xml-serialization-of-a-dom-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-7">producing an XML serialization of a DOM node</a> of type <a href="#dfn-documenttype" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-documenttype-4">DocumentType</a>
  is as follows:

  <ol>
    <li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-26"><var>require well-formed</var></a> flag is <code>true</code> and the <var>node</var>'s
    <code><a href="#dfn-publicid" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-publicid-1">publicId</a></code> attribute contains characters that are not matched by the XML
    <a href="#dfn-pubidchar" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-pubidchar-1">PubidChar</a> production, then <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-8">throw an exception</a>; the serialization of this
    <var>node</var> would not be a well-formed document type declaration.

    </li><li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-27"><var>require well-formed</var></a> flag is <code>true</code> and the <var>node</var>'s
    <code><a href="#dfn-systemid" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-systemid-1">systemId</a></code> attribute contains characters that are not matched by the XML
    <a href="#dfn-char" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-char-4">Char</a> production or that contains both a "<code>"</code>" (U+0022 QUOTATION MARK) and a
    "<code>'</code>" (U+0027 APOSTROPHE), then <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-9">throw an exception</a>; the serialization of this
    <var>node</var> would not be a well-formed document type declaration.

    </li><li>Let <var>markup</var> be an empty string.

    </li><li>Append the string "<code>&lt;!DOCTYPE</code>" to <var>markup</var>.

    </li><li>Append "<code> </code>" (U+0020 SPACE) to <var>markup</var>.

    </li><li>Append the value of the <var>node</var>'s <code><a data-lt="doctype name" href="#dfn-doctype-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-doctype-name-1">name</a></code>
    attribute to <var>markup</var>. For a <var>node</var> belonging to an <a href="#dfn-html-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-html-document-3">HTML document</a>, the
    value will be all lowercase.

    </li><li>If the <var>node</var>'s <code><a href="#dfn-publicid" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-publicid-2">publicId</a></code> is not the empty string then append
    the following, in the order listed, to <var>markup</var>:
    <ol>
      <li>"<code> </code>" (U+0020 SPACE);

      </li><li>The string "<code>PUBLIC</code>";

      </li><li>"<code> </code>" (U+0020 SPACE);

      </li><li>"<code>"</code>" (U+0022 QUOTATION MARK);

      </li><li>The value of the <var>node</var>'s <code><a href="#dfn-publicid" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-publicid-3">publicId</a></code> attribute;

      </li><li>"<code>"</code>" (U+0022 QUOTATION MARK).
    </li></ol>

    </li><li>If the <var>node</var>'s <code><a href="#dfn-systemid" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-systemid-2">systemId</a></code> is not the empty string and the
    <var>node</var>'s <code><a href="#dfn-publicid" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-publicid-4">publicId</a></code> is set to the empty string, then append the
    following, in the order listed, to <var>markup</var>:
    <ol>
      <li>"<code> </code>" (U+0020 SPACE);

      </li><li>The string "<code>SYSTEM</code>".
    </li></ol>

    </li><li>If the <var>node</var>'s <code><a href="#dfn-systemid" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-systemid-3">systemId</a></code> is not the empty string then append
    the following, in the order listed, to <var>markup</var>:
    <ol>
      <li>"<code> </code>" (U+0020 SPACE);

      </li><li>"<code>"</code>" (U+0022 QUOTATION MARK);

      </li><li>The value of the <var>node</var>'s <code><a href="#dfn-systemid" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-systemid-4">systemId</a></code> attribute;

      </li><li>"<code>"</code>" (U+0022 QUOTATION MARK).
    </li></ol>

    
    </li><li>Append "<code>&gt;</code>" (U+003E GREATER-THAN SIGN) to <var>markup</var>.

    </li><li>Return the value of <var>markup</var>.
  </li></ol>

</section>

<section id="xml-serializing-a-processinginstruction-node"><div class="header-wrapper"><h5 id="x3-2-1-7-xml-serializing-a-processinginstruction-node"><bdi class="secno">3.2.1.7 </bdi><dfn id="dfn-xml-serializing-a-processinginstruction-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">XML serializing a ProcessingInstruction node</dfn></h5><a class="self-link" href="#xml-serializing-a-processinginstruction-node" aria-label="Permalink for Section 3.2.1.7"></a></div>

  The algorithm for <a href="#dfn-producing-an-xml-serialization-of-a-dom-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-8">producing an XML serialization of a DOM node</a> of type
  <a href="#dfn-processinginstruction" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-processinginstruction-4">ProcessingInstruction</a> is as follows:

  <ol>
    <li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-28"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and
    <var>node</var>'s <code><a href="#dfn-target" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-target-1">target</a></code> contains a "<code>:</code>" (U+003A COLON)
    character or is an <a href="#dfn-ascii-case-insensitive" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-ascii-case-insensitive-9">ASCII case-insensitive</a> match for the string "<code>xml</code>", then
    <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-10">throw an exception</a>; the serialization of this <var>node</var>'s
    <code><a href="#dfn-target" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-target-2">target</a></code> would not be well-formed.

    </li><li>If the <a href="#dfn-require-well-formed" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-require-well-formed-29"><var>require well-formed</var></a> flag is set (its value is <code>true</code>), and
    <var>node</var>'s <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-7">data</a></code> contains characters that are not matched by the XML
    <a href="#dfn-char" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-char-5">Char</a> production or contains the string "<code>?&gt;</code>" (U+003F QUESTION MARK,
    U+003E GREATER-THAN SIGN), then <a href="#dfn-throw-an-exception" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-throw-an-exception-11">throw an exception</a>; the serialization of this
    <var>node</var>'s <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-8">data</a></code> would not be well-formed.

    </li><li>Let <var>markup</var> be the concatenation of the following, in the order listed:
    <ol>
      <li>"<code>&lt;?</code>" (U+003C LESS-THAN SIGN, U+003F QUESTION MARK);

      </li><li>The value of <var>node</var>'s <code><a href="#dfn-target" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-target-3">target</a></code>;

      </li><li>"<code> </code>" (U+0020 SPACE);

      </li><li>The value of <var>node</var>'s <code><a href="#dfn-data" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-9">data</a></code>;

      </li><li>"<code>?&gt;</code>" (U+003F QUESTION MARK, U+003E GREATER-THAN SIGN).
    </li></ol>

    </li><li>Return the value of <var>markup</var>.
  </li></ol>

</section>

</section>

</section>

</section>




<section class="appendix" id="dependencies"><div class="header-wrapper"><h2 id="a-dependencies"><bdi class="secno">A. </bdi>Dependencies</h2><a class="self-link" href="#dependencies" aria-label="Permalink for Appendix A."></a></div>
  

  The HTML specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-html5" title="HTML5">HTML5</a></cite>] defines the following terms used in this document:

  <ul>
    <li>The general concepts:
        an <dfn id="dfn-active-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;active document&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/html5/single-page.html#active-document">active document</a></dfn>;
    </li><li>Parsing concepts:
        the <dfn id="dfn-fragment-parsing-algorithm-0" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/dynamic-markup-insertion.html#fragment-parsing-algorithm-steps">fragment parsing algorithm</a></dfn>;
        the <dfn id="dfn-fragment-serializing-algorithm-0" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/dynamic-markup-insertion.html#fragment-serializing-algorithm-steps">fragment serializing algorithm</a></dfn>;
        <dfn id="dfn-html-parser" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/html5/single-page.html#html-parser">HTML parser</a></dfn>;
        <dfn id="dfn-parsing-xhtml-documents" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/html5/single-page.html#parsing-xhtml-documents">parsing XHTML documents</a></dfn>;
        <dfn id="dfn-xml-parser" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/html5/single-page.html#xml-parser">XML parser</a></dfn>;
    </li><li>A document <dfn id="dfn-location" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;location&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/html5/single-page.html#location">location</a></dfn>
    </li><li>The following elements:
        <dfn id="dfn-meta" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;meta&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/html5/single-page.html#meta">meta</a></dfn>,
        <dfn id="dfn-noscript" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;noscript&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/html5/single-page.html#the-noscript-element">noscript</a></dfn>,
        <dfn id="dfn-script" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;script&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/html5/single-page.html#script">script</a></dfn> and
        <dfn id="dfn-template" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/html5/single-page.html#the-template-element">template</a></dfn>
    </li><li><dfn id="dfn-void-elements" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/html5/single-page.html#void-elements">void elements</a></dfn>
    </li><li>The <a href="#dfn-template" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-template-7">template</a>'s <dfn data-lt="template content|template contents" id="dfn-template-content" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/html5/single-page.html#template-contents">template contents</a></dfn>
    </li><li>The <dfn data-lt="CEReactions|[CEReactions]" id="dfn-cereactions" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;[CEReactions]&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/html5/single-page.html#cereactios">[CEReactions]</a></dfn> IDL <a data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-extended-attribute">extended attribute</a>
    </li><li>The <dfn id="dfn-innerhtml" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/dynamic-markup-insertion.html#dom-element-innerhtml">innerHTML</a></dfn> property;
  </li></ul>

  The DOM specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-dom4" title="DOM Standard">DOM4</a></cite>] defines the following terms used in this document:

  <ul>
    <li>The following concepts:
      <dfn id="dfn-case-sensitive" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#case-sensitive">case-sensitive</a></dfn> and
      <dfn id="dfn-ascii-case-insensitive" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#ascii-case-insensitive">ASCII case-insensitive</a></dfn> string comparisons;
      a node's <dfn data-lt="child|child nodes|children" id="dfn-child" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-tree-child">children</a></dfn>,
      <dfn id="dfn-first-child" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-tree-first-child">first child</a></dfn>,
      <dfn id="dfn-next-sibling" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-tree-next-sibling">next sibling</a></dfn> and
      <dfn id="dfn-parent" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-tree-parent">parent</a></dfn>;
      the <dfn id="dfn-content-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;content type&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/dom/#concept-document-content-type">content type</a></dfn> and
      <dfn id="dfn-encoding" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;encoding&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/dom/#concept-document-encoding">encoding</a></dfn>;
      a <dfn id="dfn-html-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#html-document">HTML document</a></dfn>;
      a <dfn id="dfn-local-name" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-element-local-name">local name</a></dfn>;
      a <dfn data-lt="concept namespace|namespace concept" id="dfn-concept-namespace" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-element-namespace">namespace</a> concept</dfn>;
      a <dfn id="dfn-node-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-node-document">node document</a></dfn>;
      the <dfn id="dfn-append" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-node-append">append</a></dfn>,
      <dfn id="dfn-insert" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-node-insert">insert</a></dfn> and
      <dfn id="dfn-replace" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-node-replace">replace</a></dfn> operations;
      <dfn id="dfn-tree-order" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-tree-order">tree order</a></dfn>;
      a range's <dfn id="dfn-start-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#concept-range-start-node">start node</a></dfn>;
      document <dfn id="dfn-url" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;URL&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/dom/#concept-document-url">URL</a></dfn>;
      a <dfn id="dfn-xml-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#xml-document">XML document</a></dfn>;
    </li>
    <li>The <dfn data-lt="attribute|Attr" id="dfn-attribute" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#interface-attr">Attr</a></dfn> interface and its
        <dfn data-lt="attr localName|attr.localName" id="dfn-attr-localname" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">attr.<a href="https://www.w3.org/TR/dom/#dom-attr-localname">localName</a></dfn>,
        <dfn data-lt="namespaceURI|attr.namespaceURI" id="dfn-namespaceuri" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">attr.<a href="https://www.w3.org/TR/dom/#dom-attr-namespaceuri">namespaceURI</a></dfn>,
        <dfn data-lt="prefix|attr.prefix" id="dfn-prefix" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">attr.<a href="https://www.w3.org/TR/dom/#dom-attr-prefix">prefix</a></dfn> and
        <dfn data-lt="value|attr.value" id="dfn-value" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">attr.<a href="https://www.w3.org/TR/dom/#dom-attr-value">value</a></dfn> attributes
    </li><li>The CharacterData interface's <dfn id="dfn-data" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#dom-characterdata-data">data</a></dfn> attribute
    </li><li>The <dfn id="dfn-comment" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#interface-comment">Comment</a></dfn> interface

    </li><li>The <dfn id="dfn-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#document">Document</a></dfn> interface and its
        <dfn id="dfn-doctype" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;doctype&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/dom/#dom-document-doctype">doctype</a></dfn> and
        <dfn id="dfn-documentelement" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#dom-document-documentelement">documentElement</a></dfn> attribute
    </li><li>The <dfn id="dfn-documenttype" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#interface-documenttype">DocumentType</a></dfn> interface and its
        <dfn data-lt="doctype name|doctype.name" id="dfn-doctype-name" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">doctype.<a href="https://www.w3.org/TR/dom/#dom-documenttype-name">name</a></dfn>,
    
        <dfn id="dfn-publicid" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#dom-documenttype-publicid">publicId</a></dfn> and
        <dfn id="dfn-systemid" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#dom-documenttype-systemid">systemId</a></dfn> attributes
    </li><li>The <dfn id="dfn-documentfragment" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#documentfragment">DocumentFragment</a></dfn> interface
    </li><li>The <dfn data-lt="Element|Elements" data-plurals="elements" id="dom-element" data-idl="interface" data-title="Element" data-dfn-for="" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code><a href="https://www.w3.org/TR/dom/#element">Element</a></code></dfn> interface and its
        <dfn data-lt="attributes|attribute list" id="dfn-attributes" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#dom-element-attributes">attributes</a></dfn> list,
        <dfn data-lt="localName|element.localName" id="dfn-localname" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">element.<a href="https://www.w3.org/TR/dom/#dom-element-localname">localName</a></dfn>,
        <dfn id="dfn-element-namespaceuri" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;element.namespaceURI&quot;, but nothing links to it. This is usually a spec bug!">element.<a href="https://www.w3.org/TR/dom/#dom-element-namespaceuri">namespaceURI</a></dfn> and
        <dfn id="dfn-element-prefix" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;element.prefix&quot;, but nothing links to it. This is usually a spec bug!">element.<a href="https://www.w3.org/TR/dom/#dom-element-prefix">prefix</a></dfn> attributes,
        <dfn id="dfn-setattribute" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#dom-element-setattribute">setAttribute</a></dfn> method
    </li><li>The <dfn data-lt="Node|Nodes" id="dfn-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#node">Node</a></dfn> interface
    </li><li>The <dfn id="dfn-processinginstruction" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#interface-processinginstruction">ProcessingInstruction</a></dfn> interface and its
        <dfn id="dfn-target" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#dom-processinginstruction-target">target</a></dfn> attribute
    </li><li>The <dfn id="dom-range" data-idl="interface" data-title="Range" data-dfn-for="" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code><a href="https://www.w3.org/TR/dom/#range">Range</a></code></dfn> interface
    </li><li>The <dfn id="dfn-text" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#interface-text">Text</a></dfn> interface
    </li><li>The following <dfn id="dfn-domexception" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#domexception">DOMException</a></dfn>s:
        "<dfn id="dfn-invalidstateerror" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#invalidstateerror">InvalidStateError</a></dfn>",
        "<dfn id="dfn-nomodificationallowederror" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#nomodificationallowederror">NoModificationAllowedError</a></dfn>" and
        "<dfn id="dfn-syntaxerror" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/dom/#syntaxerror">SyntaxError</a></dfn>",
    </li><li><dfn id="dfn-xmldocument" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;XMLDocument&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://www.w3.org/TR/dom/#xmldocument">XMLDocument</a></dfn>
  </li></ul>

  The following terms used in this document are defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-dom4" title="DOM Standard">DOM</a></cite>]:

  <ul>
    <li>The <dfn id="dfn-shadowroot" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a href="https://dom.spec.whatwg.org/#shadowroot">ShadowRoot</a></dfn> interface
  </li></ul>

  The following terms used in this document are defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-xml10" title="Extensible Markup Language (XML) 1.0 (Fifth Edition)">XML10</a></cite>]:

  <ul>
    <li>The <dfn id="dfn-attvalue" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/xml/#NT-AttValue"><code>AttValue</code></a></dfn>,
        <dfn id="dfn-char" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/xml/#NT-Char"><code>Char</code></a></dfn>,
        <dfn id="dfn-emptyelemtag" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/xml/#NT-EmptyElemTag"><code>EmptyElemTag</code></a></dfn>,
        <dfn id="dfn-name" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/xml/#NT-Name"><code>Name</code></a></dfn> and
        <dfn id="dfn-pubidchar" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/xml/#NT-PubidChar"><code>PubidChar</code></a></dfn> productions
    </li><li><dfn id="dfn-empty-element-tag" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/xml/#dt-eetag">empty-element tag</a></dfn>
  </li></ul>

  The ECMAScript [<cite><a class="bibref" data-link-type="biblio" href="#bib-ecma-262" title="ECMAScript Language Specification">ECMA-262</a></cite>] (commonly "JavaScript") specification defines these terms:

  <ul>
    <li>The <dfn id="dfn-typeerror" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://tc39.github.io/ecma262/#sec-error-objects">TypeError</a></dfn> exception
  </li></ul>

  The Web IDL [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>] specification defines:

  <ul>
    <li>The <dfn data-lt="LegacyNullToEmptyString|[LegacyNullToEmptyString]" id="dfn-legacynulltoemptystring" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn" class="respec-offending-element" title="Found definition for &quot;[LegacyNullToEmptyString]&quot;, but nothing links to it. This is usually a spec bug!"><a href="https://heycam.github.io/webidl/#LegacyNullToEmptyString">[LegacyNullToEmptyString]</a></dfn> IDL <a data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-extended-attribute">extended attribute</a>
  </li></ul>

  The Trusted Types [<cite><a class="bibref" data-link-type="biblio" href="#bib-trusted-types" title="Trusted Types">TRUSTED-TYPES</a></cite>] specification defines:

  <ul>
    <li>The <dfn data-lt="HTMLString" id="dfn-htmlstring" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://w3c.github.io/trusted-types/dist/spec/#typedefdef-htmlstring">HTMLString</a></dfn> IDL <a data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-typedef">typedef</a>
  </li></ul>
</section>

<section class="appendix" id="revision-history"><div class="header-wrapper"><h2 id="b-revision-history"><bdi class="secno">B. </bdi>Revision History</h2><a class="self-link" href="#revision-history" aria-label="Permalink for Appendix B."></a></div>
  

  The following is an informative summary of the changes since the last publication of this
  specification. A complete revision history of the Editor's Drafts of this specification can be
  found at the
  <a href="https://github.com/w3c/DOM-Parsing/commits/gh-pages"><abbr title="World Wide Web Consortium">W3C</abbr> Github Repository</a> and older
  revisions at the
  <a href="https://dvcs.w3.org/hg/innerhtml/summary/"><abbr title="World Wide Web Consortium">W3C</abbr> Mercurial server</a>.

  <ul>
    <li>2016-06 WD - Editorial restructuring of the document; monolithic XML serialization algorithm
    factored into sections. Dependencies clarified. XML Serialization algorithm updated to get
    closer to interoperable browser behavior.

    </li><li><a href="https://dvcs.w3.org/hg/innerhtml/raw-file/tip/LC2_comments.html">Incorporated
      non-normative changes from previous Last Call document.</a>
  </li></ul>
</section>

<section class="appendix" id="acknowledgements"><div class="header-wrapper"><h2 id="c-acknowledgements"><bdi class="secno">C. </bdi>Acknowledgements</h2><a class="self-link" href="#acknowledgements" aria-label="Permalink for Appendix C."></a></div>
  

  <p>We acknowledge with gratitude the original work of Ms2ger and others at the WHATWG, who created
  and maintained the original DOM Parsing and Serialization Living Standard upon which this
  specification is based.

  </p><p>Thanks to
  C. Scott Ananian,
  Victor Costan,
  Aryeh Gregor,
  Anne van Kesteren,
  Arkadiusz Michalski,
  Simon Pieters,
  Henri Sivonen,
  Josh Soref
  and Boris Zbarsky,
  for their useful comments.

  </p><p>Special thanks to Ian Hickson for first defining the <a href="#dfn-innerhtml" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-innerhtml-5">innerHTML</a> and <a href="#dom-element-outerhtml" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-outerhtml-3"><code>outerHTML</code></a>
  attributes, and the <a href="#dom-element-insertadjacenthtml" class="internalDFN" data-link-type="idl" id="ref-for-dom-element-insertadjacenthtml-5"><code>insertAdjacentHTML</code></a> method in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html5" title="HTML5">HTML5</a></cite>] and his useful comments.
</p></section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="d-references"><bdi class="secno">D. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix D."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix D.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-dom4">[DOM4]</dt><dd>
      <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
    </dd><dt id="bib-ecma-262">[ECMA-262]</dt><dd>
      <a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>.  Ecma International. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
    </dd><dt id="bib-html">[html]</dt><dd>
      <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
    </dd><dt id="bib-html5">[HTML5]</dt><dd>
      <a href="https://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. Ian Hickson; Robin Berjon; Steve Faulkner; Travis Leithead; Erika Doyle Navara; Theresa O'Connor; Silvia Pfeiffer.  W3C. 27 March 2018. W3C Recommendation. URL: <a href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
    </dd><dt id="bib-trusted-types">[TRUSTED-TYPES]</dt><dd>
      <a href="https://www.w3.org/TR/trusted-types/"><cite>Trusted Types</cite></a>. Krzysztof Kotowicz.  W3C. 27 September 2022. W3C Working Draft. URL: <a href="https://www.w3.org/TR/trusted-types/">https://www.w3.org/TR/trusted-types/</a>
    </dd><dt id="bib-webidl">[WEBIDL]</dt><dd>
      <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dd><dt id="bib-xml10">[XML10]</dt><dd>
      <a href="https://www.w3.org/TR/xml/"><cite>Extensible Markup Language (XML) 1.0 (Fifth Edition)</cite></a>. Tim Bray; Jean Paoli; Michael Sperberg-McQueen; Eve Maler; François Yergeau et al.  W3C. 26 November 2008. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xml/">https://www.w3.org/TR/xml/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-applicable-specification" aria-label="Links in this document to definition: applicable specification">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-applicable-specification" aria-label="Permalink for definition: applicable specification. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-parsing" aria-label="Links in this document to definition: Parsing">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-parsing" aria-label="Permalink for definition: Parsing. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-parsing-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-serializing" aria-label="Links in this document to definition: Serializing">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-serializing" aria-label="Permalink for definition: Serializing. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-serializing-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-round-tripping" aria-label="Links in this document to definition: Round-tripping">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-round-tripping" aria-label="Permalink for definition: Round-tripping. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-round-tripping-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-round-tripping-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-round-tripping-3" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-context-object" aria-label="Links in this document to definition: context object">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-context-object" aria-label="Permalink for definition: context object. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-context-object-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-context-object-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-context-object-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-context-object-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-context-object-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-context-object-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-context-object-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-context-object-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-context-object-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-context-object-10" title="Reference 10">(10)</a> <a href="#ref-for-dfn-context-object-11" title="Reference 11">(11)</a> <a href="#ref-for-dfn-context-object-12" title="Reference 12">(12)</a> <a href="#ref-for-dfn-context-object-13" title="Reference 13">(13)</a> <a href="#ref-for-dfn-context-object-14" title="Reference 14">(14)</a> 
    </li><li>
      <a href="#ref-for-dfn-context-object-15" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dfn-context-object-16" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-html-namespace" aria-label="Links in this document to definition: HTML namespace">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-html-namespace" aria-label="Permalink for definition: HTML namespace. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-html-namespace-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-html-namespace-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-html-namespace-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-html-namespace-4" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dfn-html-namespace-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-html-namespace-6" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-html-namespace-7" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-html-namespace-8" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-html-namespace-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-html-namespace-10" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-namespace" aria-label="Links in this document to definition: XML namespace">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-namespace" aria-label="Permalink for definition: XML namespace. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-namespace-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-xml-namespace-2" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-xml-namespace-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-xml-namespace-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-xml-namespace-5" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> <a href="#ref-for-dfn-xml-namespace-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-xml-namespace-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-xml-namespace-8" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-xml-namespace-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-xml-namespace-10" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xmlns-namespace" aria-label="Links in this document to definition: XMLNS namespace">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xmlns-namespace" aria-label="Permalink for definition: XMLNS namespace. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xmlns-namespace-1" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> <a href="#ref-for-dfn-xmlns-namespace-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-xmlns-namespace-3" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-xmlns-namespace-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-xmlns-namespace-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-xmlns-namespace-6" title="Reference 4">(4)</a> <a href="#ref-for-dfn-xmlns-namespace-7" title="Reference 5">(5)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-xmlserializer-constructor" aria-label="Links in this document to definition: constructor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-xmlserializer-constructor" aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-xmlserializer" aria-label="Links in this document to definition: XMLSerializer">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-xmlserializer" aria-label="Permalink for definition: XMLSerializer. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1703602265">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-xmlserializer-1" title="§ 2.2 The XMLSerializer interface">§ 2.2 The XMLSerializer interface</a> <a href="#ref-for-dom-xmlserializer-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-xmlserializer-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-xmlserializer-serializetostring" aria-label="Links in this document to definition: serializeToString">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-xmlserializer-serializetostring" aria-label="Permalink for definition: serializeToString. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1703602265">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-xmlserializer-serializetostring-1" title="§ 2.2 The XMLSerializer interface">§ 2.2 The XMLSerializer interface</a> <a href="#ref-for-dom-xmlserializer-serializetostring-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-element-outerhtml" aria-label="Links in this document to definition: outerHTML">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-element-outerhtml" aria-label="Permalink for definition: outerHTML. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1069524514">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-element-outerhtml-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dom-element-outerhtml-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-element-outerhtml-3" title="§ C. Acknowledgements">§ C. Acknowledgements</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-element-insertadjacenthtml" aria-label="Links in this document to definition: insertAdjacentHTML(position, text)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-element-insertadjacenthtml" aria-label="Permalink for definition: insertAdjacentHTML(position, text). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1069524514">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-element-insertadjacenthtml-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dom-element-insertadjacenthtml-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-element-insertadjacenthtml-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-element-insertadjacenthtml-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-element-insertadjacenthtml-5" title="§ C. Acknowledgements">§ C. Acknowledgements</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-range-createcontextualfragment" aria-label="Links in this document to definition: createContextualFragment(fragment)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-range-createcontextualfragment" aria-label="Permalink for definition: createContextualFragment(fragment). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1881988415">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-range-createcontextualfragment-1" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dom-range-createcontextualfragment-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serialization" aria-label="Links in this document to definition: XML serialization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serialization" aria-label="Permalink for definition: XML serialization. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serialization-1" title="§ 2.2 The XMLSerializer interface">§ 2.2 The XMLSerializer interface</a> 
    </li><li>
      <a href="#ref-for-dfn-xml-serialization-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-xml-serialization-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-xml-serialization-4" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-require-well-formed" aria-label="Links in this document to definition: require well-formed">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-require-well-formed" aria-label="Permalink for definition: require well-formed. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-require-well-formed-1" title="§ 2.2 The XMLSerializer interface">§ 2.2 The XMLSerializer interface</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-2" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-3" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-require-well-formed-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-require-well-formed-5" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-6" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-require-well-formed-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-require-well-formed-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-require-well-formed-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-require-well-formed-10" title="Reference 5">(5)</a> <a href="#ref-for-dfn-require-well-formed-11" title="Reference 6">(6)</a> <a href="#ref-for-dfn-require-well-formed-12" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-13" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-require-well-formed-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-require-well-formed-15" title="Reference 3">(3)</a> <a href="#ref-for-dfn-require-well-formed-16" title="Reference 4">(4)</a> <a href="#ref-for-dfn-require-well-formed-17" title="Reference 5">(5)</a> <a href="#ref-for-dfn-require-well-formed-18" title="Reference 6">(6)</a> <a href="#ref-for-dfn-require-well-formed-19" title="Reference 7">(7)</a> <a href="#ref-for-dfn-require-well-formed-20" title="Reference 8">(8)</a> <a href="#ref-for-dfn-require-well-formed-21" title="Reference 9">(9)</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-22" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-23" title="§ 3.2.1.3 XML serializing a Comment node">§ 3.2.1.3 XML serializing a Comment node</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-24" title="§ 3.2.1.4 XML serializing a Text node">§ 3.2.1.4 XML serializing a Text node</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-25" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-26" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> <a href="#ref-for-dfn-require-well-formed-27" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-require-well-formed-28" title="§ 3.2.1.7 XML serializing a ProcessingInstruction node">§ 3.2.1.7 XML serializing a ProcessingInstruction node</a> <a href="#ref-for-dfn-require-well-formed-29" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-context-namespace" aria-label="Links in this document to definition: context namespace">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-context-namespace" aria-label="Permalink for definition: context namespace. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-context-namespace-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-context-namespace-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-context-namespace-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-context-namespace-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-context-namespace-5" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-context-namespace-6" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-generated-namespace-prefix-index" aria-label="Links in this document to definition: generated namespace prefix index">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-generated-namespace-prefix-index" aria-label="Permalink for definition: generated namespace prefix index. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-generated-namespace-prefix-index-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-generated-namespace-prefix-index-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-generated-namespace-prefix-index-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-generated-namespace-prefix-index-4" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-generated-namespace-prefix-index-5" title="§ 3.2.1.1.4 Generating namespace prefixes">§ 3.2.1.1.4 Generating namespace prefixes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-throw-an-exception" aria-label="Links in this document to definition: exception">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-throw-an-exception" aria-label="Permalink for definition: exception. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-throw-an-exception-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-throw-an-exception-2" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-throw-an-exception-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-throw-an-exception-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-throw-an-exception-5" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-throw-an-exception-6" title="§ 3.2.1.3 XML serializing a Comment node">§ 3.2.1.3 XML serializing a Comment node</a> 
    </li><li>
      <a href="#ref-for-dfn-throw-an-exception-7" title="§ 3.2.1.4 XML serializing a Text node">§ 3.2.1.4 XML serializing a Text node</a> 
    </li><li>
      <a href="#ref-for-dfn-throw-an-exception-8" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> <a href="#ref-for-dfn-throw-an-exception-9" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-throw-an-exception-10" title="§ 3.2.1.7 XML serializing a ProcessingInstruction node">§ 3.2.1.7 XML serializing a ProcessingInstruction node</a> <a href="#ref-for-dfn-throw-an-exception-11" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-producing-an-xml-serialization-of-a-dom-node" aria-label="Links in this document to definition: producing an XML serialization of a DOM node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-producing-an-xml-serialization-of-a-dom-node" aria-label="Permalink for definition: producing an XML serialization of a DOM node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-2" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-3" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-4" title="§ 3.2.1.3 XML serializing a Comment node">§ 3.2.1.3 XML serializing a Comment node</a> 
    </li><li>
      <a href="#ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-5" title="§ 3.2.1.4 XML serializing a Text node">§ 3.2.1.4 XML serializing a Text node</a> 
    </li><li>
      <a href="#ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-6" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li><li>
      <a href="#ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-7" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> 
    </li><li>
      <a href="#ref-for-dfn-producing-an-xml-serialization-of-a-dom-node-8" title="§ 3.2.1.7 XML serializing a ProcessingInstruction node">§ 3.2.1.7 XML serializing a ProcessingInstruction node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-namespace" aria-label="Links in this document to definition: namespace">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-namespace" aria-label="Permalink for definition: namespace. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-namespace-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-namespace-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-namespace-3" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-namespace-4" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-prefix-map" aria-label="Links in this document to definition: prefix map">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-prefix-map" aria-label="Permalink for definition: prefix map. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-prefix-map-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-prefix-map-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-prefix-map-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-prefix-map-4" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-prefix-map-5" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-prefix-index" aria-label="Links in this document to definition: prefix index">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-prefix-index" aria-label="Permalink for definition: prefix index. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-prefix-index-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-prefix-index-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-prefix-index-3" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-prefix-index-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-prefix-index-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-prefix-index-6" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-prefix-index-7" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serialization-algorithm" aria-label="Links in this document to definition: XML serialization algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serialization-algorithm" aria-label="Permalink for definition: XML serialization algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serialization-algorithm-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-xml-serialization-algorithm-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-xml-serialization-algorithm-3" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-xml-serialization-algorithm-4" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-xml-serialization-algorithm-5" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serializing-an-element-node" aria-label="Links in this document to definition: XML serializing an Element node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serializing-an-element-node" aria-label="Permalink for definition: XML serializing an Element node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serializing-an-element-node-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-qualified-name" aria-label="Links in this document to definition: qualified name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-qualified-name" aria-label="Permalink for definition: qualified name. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-qualified-name-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-qualified-name-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-qualified-name-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-qualified-name-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-qualified-name-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-qualified-name-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-qualified-name-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-qualified-name-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-qualified-name-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-qualified-name-10" title="Reference 10">(10)</a> <a href="#ref-for-dfn-qualified-name-11" title="Reference 11">(11)</a> <a href="#ref-for-dfn-qualified-name-12" title="Reference 12">(12)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-skip-end-tag" aria-label="Links in this document to definition: skip end tag">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-skip-end-tag" aria-label="Permalink for definition: skip end tag. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-skip-end-tag-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-skip-end-tag-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-skip-end-tag-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-ignore-namespace-definition-attribute" aria-label="Links in this document to definition: ignore namespace definition attribute">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-ignore-namespace-definition-attribute" aria-label="Permalink for definition: ignore namespace definition attribute. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-ignore-namespace-definition-attribute-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-ignore-namespace-definition-attribute-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-ignore-namespace-definition-attribute-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-ignore-namespace-definition-attribute-4" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-ignore-namespace-definition-attribute-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-local-prefixes-map" aria-label="Links in this document to definition: local prefixes map">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-local-prefixes-map" aria-label="Permalink for definition: local prefixes map. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-local-prefixes-map-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-local-prefixes-map-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-local-prefixes-map-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-local-prefixes-map-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-local-prefixes-map-5" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> <a href="#ref-for-dfn-local-prefixes-map-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-local-prefixes-map-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-local-prefixes-map-8" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-local-prefixes-map-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-local-prefixes-map-10" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-local-default-namespace" aria-label="Links in this document to definition: local default namespace">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-local-default-namespace" aria-label="Permalink for definition: local default namespace. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-local-default-namespace-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-local-default-namespace-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-local-default-namespace-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-local-default-namespace-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-local-default-namespace-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-local-default-namespace-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-local-default-namespace-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-local-default-namespace-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-local-default-namespace-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-local-default-namespace-10" title="Reference 10">(10)</a> <a href="#ref-for-dfn-local-default-namespace-11" title="Reference 11">(11)</a> 
    </li><li>
      <a href="#ref-for-dfn-local-default-namespace-12" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-inherited-ns" aria-label="Links in this document to definition: inherited ns">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-inherited-ns" aria-label="Permalink for definition: inherited ns. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-inherited-ns-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-inherited-ns-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-inherited-ns-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-inherited-ns-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-inherited-ns-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-inherited-ns-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-inherited-ns-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-inherited-ns-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-inherited-ns-9" title="Reference 9">(9)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-found-a-suitable-namespace-prefix" aria-label="Links in this document to definition: Found a suitable namespace prefix">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-found-a-suitable-namespace-prefix" aria-label="Permalink for definition: Found a suitable namespace prefix. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-found-a-suitable-namespace-prefix-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-recording-the-namespace-information" aria-label="Links in this document to definition: recording the namespace information">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-recording-the-namespace-information" aria-label="Permalink for definition: recording the namespace information. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-recording-the-namespace-information-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-main" aria-label="Links in this document to definition: Main">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-main" aria-label="Permalink for definition: Main. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-main-1" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> <a href="#ref-for-dfn-main-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-main-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-namespace-prefix-map" aria-label="Links in this document to definition: namespace prefix map">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-namespace-prefix-map" aria-label="Permalink for definition: namespace prefix map. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-namespace-prefix-map-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-namespace-prefix-map-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-namespace-prefix-map-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-namespace-prefix-map-4" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-namespace-prefix-map-5" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> <a href="#ref-for-dfn-namespace-prefix-map-6" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-namespace-prefix-map-7" title="§ 3.2.1.1.2 The Namespace Prefix Map">§ 3.2.1.1.2 The Namespace Prefix Map</a> <a href="#ref-for-dfn-namespace-prefix-map-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-namespace-prefix-map-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-namespace-prefix-map-10" title="Reference 4">(4)</a> <a href="#ref-for-dfn-namespace-prefix-map-11" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-namespace-prefix-map-12" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-namespace-prefix-map-13" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-namespace-prefix-map-14" title="§ 3.2.1.1.4 Generating namespace prefixes">§ 3.2.1.1.4 Generating namespace prefixes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-list" aria-label="Links in this document to definition: namespace prefix lists">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-list" aria-label="Permalink for definition: namespace prefix lists. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-list-1" title="§ 3.2.1.1.2 The Namespace Prefix Map">§ 3.2.1.1.2 The Namespace Prefix Map</a> <a href="#ref-for-dfn-list-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-list-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-list-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-list-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-list-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-list-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-list-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-list-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-list-10" title="Reference 10">(10)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-copy-a-namespace-prefix-map" aria-label="Links in this document to definition: copy a namespace prefix map">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-copy-a-namespace-prefix-map" aria-label="Permalink for definition: copy a namespace prefix map. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-copy-a-namespace-prefix-map-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-copy-a-namespace-prefix-map-2" title="§ 3.2.1.1.2 The Namespace Prefix Map">§ 3.2.1.1.2 The Namespace Prefix Map</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-retrieving-a-preferred-prefix-string" aria-label="Links in this document to definition: retrieve a preferred prefix string">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-retrieving-a-preferred-prefix-string" aria-label="Permalink for definition: retrieve a preferred prefix string. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-retrieving-a-preferred-prefix-string-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-retrieving-a-preferred-prefix-string-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-retrieving-a-preferred-prefix-string-3" title="§ 3.2.1.1.2 The Namespace Prefix Map">§ 3.2.1.1.2 The Namespace Prefix Map</a> <a href="#ref-for-dfn-retrieving-a-preferred-prefix-string-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-retrieving-a-preferred-prefix-string-5" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-found" aria-label="Links in this document to definition: found">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-found" aria-label="Permalink for definition: found. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-found-1" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li><li>
      <a href="#ref-for-dfn-found-2" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-add" aria-label="Links in this document to definition: add">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-add" aria-label="Permalink for definition: add. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-add-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-add-2" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-add-3" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li><li>
      <a href="#ref-for-dfn-add-4" title="§ 3.2.1.1.4 Generating namespace prefixes">§ 3.2.1.1.4 Generating namespace prefixes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serialization-of-the-attributes" aria-label="Links in this document to definition: XML serialization of the attributes">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serialization-of-the-attributes" aria-label="Permalink for definition: XML serialization of the attributes. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serialization-of-the-attributes-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-xml-serialization-of-the-attributes-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-loop" aria-label="Links in this document to definition: Loop">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-loop" aria-label="Permalink for definition: Loop. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-loop-1" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-serializing-an-attribute-value" aria-label="Links in this document to definition: serializing an attribute value">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-serializing-an-attribute-value" aria-label="Permalink for definition: serializing an attribute value. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-serializing-an-attribute-value-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-serializing-an-attribute-value-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-serializing-an-attribute-value-3" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-serializing-an-attribute-value-4" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-generating-a-prefix" aria-label="Links in this document to definition: generate a prefix">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-generating-a-prefix" aria-label="Permalink for definition: generate a prefix. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-generating-a-prefix-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-generating-a-prefix-2" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-generating-a-prefix-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-generating-a-prefix-4" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serializing-a-document-node" aria-label="Links in this document to definition: XML serializing a Document node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serializing-a-document-node" aria-label="Permalink for definition: XML serializing a Document node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serializing-a-document-node-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serializing-a-comment-node" aria-label="Links in this document to definition: XML serializing a Comment node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serializing-a-comment-node" aria-label="Permalink for definition: XML serializing a Comment node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serializing-a-comment-node-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serializing-a-text-node" aria-label="Links in this document to definition: XML serializing a Text node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serializing-a-text-node" aria-label="Permalink for definition: XML serializing a Text node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serializing-a-text-node-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serializing-a-documentfragment-node" aria-label="Links in this document to definition: XML serializing a DocumentFragment node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serializing-a-documentfragment-node" aria-label="Permalink for definition: XML serializing a DocumentFragment node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serializing-a-documentfragment-node-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-xml-serializing-a-documentfragment-node-2" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serializing-a-documenttype-node" aria-label="Links in this document to definition: XML serializing a DocumentType node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serializing-a-documenttype-node" aria-label="Permalink for definition: XML serializing a DocumentType node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serializing-a-documenttype-node-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-serializing-a-processinginstruction-node" aria-label="Links in this document to definition: XML serializing a ProcessingInstruction node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-serializing-a-processinginstruction-node" aria-label="Permalink for definition: XML serializing a ProcessingInstruction node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-serializing-a-processinginstruction-node-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-active-document" aria-label="Links in this document to definition: active document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-active-document" aria-label="Permalink for definition: active document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-fragment-parsing-algorithm-0" aria-label="Links in this document to definition: fragment parsing algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-fragment-parsing-algorithm-0" aria-label="Permalink for definition: fragment parsing algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-fragment-parsing-algorithm-0-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-fragment-parsing-algorithm-0-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-fragment-parsing-algorithm-0-3" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-fragment-serializing-algorithm-0" aria-label="Links in this document to definition: fragment serializing algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-fragment-serializing-algorithm-0" aria-label="Permalink for definition: fragment serializing algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-fragment-serializing-algorithm-0-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-html-parser" aria-label="Links in this document to definition: HTML parser">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-html-parser" aria-label="Permalink for definition: HTML parser. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-html-parser-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-parsing-xhtml-documents" aria-label="Links in this document to definition: parsing XHTML documents">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-parsing-xhtml-documents" aria-label="Permalink for definition: parsing XHTML documents. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-parsing-xhtml-documents-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-parser" aria-label="Links in this document to definition: XML parser">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-parser" aria-label="Permalink for definition: XML parser. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-parser-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-location" aria-label="Links in this document to definition: location">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-location" aria-label="Permalink for definition: location. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-meta" aria-label="Links in this document to definition: meta">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-meta" aria-label="Permalink for definition: meta. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-noscript" aria-label="Links in this document to definition: noscript">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-noscript" aria-label="Permalink for definition: noscript. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-script" aria-label="Links in this document to definition: script">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-script" aria-label="Permalink for definition: script. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-template" aria-label="Links in this document to definition: template">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-template" aria-label="Permalink for definition: template. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-template-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-template-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-template-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-template-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-template-5" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-template-6" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-template-7" title="§ A. Dependencies">§ A. Dependencies</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-void-elements" aria-label="Links in this document to definition: void elements">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-void-elements" aria-label="Permalink for definition: void elements. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-void-elements-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-template-content" aria-label="Links in this document to definition: template contents">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-template-content" aria-label="Permalink for definition: template contents. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-template-content-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li><li>
      <a href="#ref-for-dfn-template-content-2" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-template-content-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cereactions" aria-label="Links in this document to definition: [CEReactions]">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cereactions" aria-label="Permalink for definition: [CEReactions]. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-innerhtml" aria-label="Links in this document to definition: innerHTML">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-innerhtml" aria-label="Permalink for definition: innerHTML. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-innerhtml-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-innerhtml-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-innerhtml-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-innerhtml-4" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li><li>
      <a href="#ref-for-dfn-innerhtml-5" title="§ C. Acknowledgements">§ C. Acknowledgements</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-case-sensitive" aria-label="Links in this document to definition: case-sensitive">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-case-sensitive" aria-label="Permalink for definition: case-sensitive. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-case-sensitive-1" title="§ Conformance">§ Conformance</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-ascii-case-insensitive" aria-label="Links in this document to definition: ASCII case-insensitive">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-ascii-case-insensitive" aria-label="Permalink for definition: ASCII case-insensitive. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-ascii-case-insensitive-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-ascii-case-insensitive-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-ascii-case-insensitive-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-ascii-case-insensitive-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-ascii-case-insensitive-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-ascii-case-insensitive-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-ascii-case-insensitive-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-ascii-case-insensitive-8" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-dfn-ascii-case-insensitive-9" title="§ 3.2.1.7 XML serializing a ProcessingInstruction node">§ 3.2.1.7 XML serializing a ProcessingInstruction node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-child" aria-label="Links in this document to definition: children">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-child" aria-label="Permalink for definition: children. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-child-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li><li>
      <a href="#ref-for-dfn-child-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-child-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-child-4" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-child-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-child-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-child-7" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-child-8" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-child-9" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-first-child" aria-label="Links in this document to definition: first child">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-first-child" aria-label="Permalink for definition: first child. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-first-child-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-next-sibling" aria-label="Links in this document to definition: next sibling">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-next-sibling" aria-label="Permalink for definition: next sibling. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-next-sibling-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-parent" aria-label="Links in this document to definition: parent">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-parent" aria-label="Permalink for definition: parent. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-parent-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-parent-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-parent-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-parent-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-parent-5" title="Reference 5">(5)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-content-type" aria-label="Links in this document to definition: content type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-content-type" aria-label="Permalink for definition: content type. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-encoding" aria-label="Links in this document to definition: encoding">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-encoding" aria-label="Permalink for definition: encoding. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-html-document" aria-label="Links in this document to definition: HTML document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-html-document" aria-label="Permalink for definition: HTML document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-html-document-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li><li>
      <a href="#ref-for-dfn-html-document-2" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li><li>
      <a href="#ref-for-dfn-html-document-3" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-local-name" aria-label="Links in this document to definition: local name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-local-name" aria-label="Permalink for definition: local name. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-local-name-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-local-name-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-local-name-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-local-name-4" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dfn-local-name-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-concept-namespace" aria-label="Links in this document to definition: namespace concept">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-concept-namespace" aria-label="Permalink for definition: namespace concept. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-concept-namespace-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-concept-namespace-2" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-concept-namespace-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-concept-namespace-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-concept-namespace-5" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dfn-concept-namespace-6" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-node-document" aria-label="Links in this document to definition: node document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-node-document" aria-label="Permalink for definition: node document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-node-document-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-node-document-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-node-document-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-node-document-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-node-document-5" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-node-document-6" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dfn-node-document-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-node-document-8" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-append" aria-label="Links in this document to definition: append">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-append" aria-label="Permalink for definition: append. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-append-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-insert" aria-label="Links in this document to definition: insert">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-insert" aria-label="Permalink for definition: insert. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-insert-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-insert-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-insert-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-replace" aria-label="Links in this document to definition: replace">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-replace" aria-label="Permalink for definition: replace. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-replace-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-tree-order" aria-label="Links in this document to definition: tree order">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-tree-order" aria-label="Permalink for definition: tree order. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-tree-order-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-tree-order-2" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-tree-order-3" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-start-node" aria-label="Links in this document to definition: start node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-start-node" aria-label="Permalink for definition: start node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-start-node-1" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-url" aria-label="Links in this document to definition: URL">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-url" aria-label="Permalink for definition: URL. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xml-document" aria-label="Links in this document to definition: XML document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xml-document" aria-label="Permalink for definition: XML document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-xml-document-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-xml-document-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-attribute" aria-label="Links in this document to definition: Attr">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-attribute" aria-label="Permalink for definition: Attr. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-attribute-1" title="§ 2.2 The XMLSerializer interface">§ 2.2 The XMLSerializer interface</a> 
    </li><li>
      <a href="#ref-for-dfn-attribute-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-attribute-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-attribute-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-attribute-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-attribute-6" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-attribute-7" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li><li>
      <a href="#ref-for-dfn-attribute-8" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-attr-localname" aria-label="Links in this document to definition: attr.localName">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-attr-localname" aria-label="Permalink for definition: attr.localName. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-attr-localname-1" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li><li>
      <a href="#ref-for-dfn-attr-localname-2" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-attr-localname-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-attr-localname-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-attr-localname-5" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-namespaceuri" aria-label="Links in this document to definition: attr.namespaceURI">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-namespaceuri" aria-label="Permalink for definition: attr.namespaceURI. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-namespaceuri-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-namespaceuri-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-namespaceuri-3" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li><li>
      <a href="#ref-for-dfn-namespaceuri-4" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-namespaceuri-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-namespaceuri-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-namespaceuri-7" title="Reference 4">(4)</a> <a href="#ref-for-dfn-namespaceuri-8" title="Reference 5">(5)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-prefix" aria-label="Links in this document to definition: attr.prefix">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-prefix" aria-label="Permalink for definition: attr.prefix. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-prefix-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-prefix-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-prefix-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-prefix-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-prefix-5" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-prefix-6" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li><li>
      <a href="#ref-for-dfn-prefix-7" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-prefix-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-prefix-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-prefix-10" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-value" aria-label="Links in this document to definition: attr.value">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-value" aria-label="Permalink for definition: attr.value. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-value-1" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> <a href="#ref-for-dfn-value-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-value-3" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-value-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-value-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-value-6" title="Reference 4">(4)</a> <a href="#ref-for-dfn-value-7" title="Reference 5">(5)</a> <a href="#ref-for-dfn-value-8" title="Reference 6">(6)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data" aria-label="Links in this document to definition: data">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-data" aria-label="Permalink for definition: data. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-data-1" title="§ 3.2.1.3 XML serializing a Comment node">§ 3.2.1.3 XML serializing a Comment node</a> <a href="#ref-for-dfn-data-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-data-4" title="§ 3.2.1.4 XML serializing a Text node">§ 3.2.1.4 XML serializing a Text node</a> <a href="#ref-for-dfn-data-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-6" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-data-7" title="§ 3.2.1.7 XML serializing a ProcessingInstruction node">§ 3.2.1.7 XML serializing a ProcessingInstruction node</a> <a href="#ref-for-dfn-data-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-9" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-comment" aria-label="Links in this document to definition: Comment">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-comment" aria-label="Permalink for definition: Comment. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-comment-1" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li><li>
      <a href="#ref-for-dfn-comment-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-comment-3" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-comment-4" title="§ 3.2.1.3 XML serializing a Comment node">§ 3.2.1.3 XML serializing a Comment node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-document" aria-label="Links in this document to definition: Document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-document" aria-label="Permalink for definition: Document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-document-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-document-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-document-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-document-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-document-5" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li><li>
      <a href="#ref-for-dfn-document-6" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-document-7" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> <a href="#ref-for-dfn-document-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-document-9" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-doctype" aria-label="Links in this document to definition: doctype">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-doctype" aria-label="Permalink for definition: doctype. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-documentelement" aria-label="Links in this document to definition: documentElement">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-documentelement" aria-label="Permalink for definition: documentElement. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-documentelement-1" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> <a href="#ref-for-dfn-documentelement-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-documentelement-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-documenttype" aria-label="Links in this document to definition: DocumentType">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-documenttype" aria-label="Permalink for definition: DocumentType. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-documenttype-1" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li><li>
      <a href="#ref-for-dfn-documenttype-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-documenttype-3" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-documenttype-4" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-doctype-name" aria-label="Links in this document to definition: doctype.name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-doctype-name" aria-label="Permalink for definition: doctype.name. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-doctype-name-1" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-publicid" aria-label="Links in this document to definition: publicId">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-publicid" aria-label="Permalink for definition: publicId. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-publicid-1" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> <a href="#ref-for-dfn-publicid-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-publicid-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-publicid-4" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-systemid" aria-label="Links in this document to definition: systemId">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-systemid" aria-label="Permalink for definition: systemId. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-systemid-1" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> <a href="#ref-for-dfn-systemid-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-systemid-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-systemid-4" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-documentfragment" aria-label="Links in this document to definition: DocumentFragment">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-documentfragment" aria-label="Permalink for definition: DocumentFragment. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-documentfragment-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li><li>
      <a href="#ref-for-dfn-documentfragment-2" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dfn-documentfragment-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-documentfragment-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-documentfragment-5" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-documentfragment-6" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-documentfragment-7" title="§ 3.2.1.5 XML serializing a DocumentFragment node">§ 3.2.1.5 XML serializing a DocumentFragment node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-element" aria-label="Links in this document to definition: Element">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-element" aria-label="Permalink for definition: Element. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-element-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dom-element-2" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dom-element-3" title="Reference 2">(2)</a> <a href="#ref-for-dom-element-4" title="Reference 3">(3)</a> <a href="#ref-for-dom-element-5" title="Reference 4">(4)</a> <a href="#ref-for-dom-element-6" title="Reference 5">(5)</a> <a href="#ref-for-dom-element-7" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dom-element-8" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dom-element-9" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-element-10" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dom-element-11" title="Reference 2">(2)</a> <a href="#ref-for-dom-element-12" title="Reference 3">(3)</a> <a href="#ref-for-dom-element-13" title="Reference 4">(4)</a> <a href="#ref-for-dom-element-14" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-element-15" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dom-element-16" title="Reference 2">(2)</a> <a href="#ref-for-dom-element-17" title="Reference 3">(3)</a> <a href="#ref-for-dom-element-18" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-element-19" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li><li>
      <a href="#ref-for-dom-element-20" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dom-element-21" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-attributes" aria-label="Links in this document to definition: attributes">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-attributes" aria-label="Permalink for definition: attributes. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-attributes-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-attributes-2" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> <a href="#ref-for-dfn-attributes-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-attributes-4" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-attributes-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-localname" aria-label="Links in this document to definition: element.localName">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-localname" aria-label="Permalink for definition: element.localName. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-localname-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-localname-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-localname-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-localname-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-localname-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-localname-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-localname-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-localname-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-localname-9" title="Reference 9">(9)</a> 
    </li><li>
      <a href="#ref-for-dfn-localname-10" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> <a href="#ref-for-dfn-localname-11" title="Reference 2">(2)</a> <a href="#ref-for-dfn-localname-12" title="Reference 3">(3)</a> <a href="#ref-for-dfn-localname-13" title="Reference 4">(4)</a> <a href="#ref-for-dfn-localname-14" title="Reference 5">(5)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-element-namespaceuri" aria-label="Links in this document to definition: element.namespaceURI">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-element-namespaceuri" aria-label="Permalink for definition: element.namespaceURI. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-element-prefix" aria-label="Links in this document to definition: element.prefix">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-element-prefix" aria-label="Permalink for definition: element.prefix. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-setattribute" aria-label="Links in this document to definition: setAttribute">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-setattribute" aria-label="Permalink for definition: setAttribute. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-setattribute-1" title="§ 3.2.1.1.1 Recording the namespace">§ 3.2.1.1.1 Recording the namespace</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-node" aria-label="Links in this document to definition: Node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-node" aria-label="Permalink for definition: Node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-node-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-node-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-node-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-node-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-node-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-node-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-node-7" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-node-8" title="§ 2.2 The XMLSerializer interface">§ 2.2 The XMLSerializer interface</a> <a href="#ref-for-dfn-node-9" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-node-10" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li><li>
      <a href="#ref-for-dfn-node-11" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-node-12" title="Reference 2">(2)</a> <a href="#ref-for-dfn-node-13" title="Reference 3">(3)</a> <a href="#ref-for-dfn-node-14" title="Reference 4">(4)</a> <a href="#ref-for-dfn-node-15" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-node-16" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> <a href="#ref-for-dfn-node-17" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-processinginstruction" aria-label="Links in this document to definition: ProcessingInstruction">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-processinginstruction" aria-label="Permalink for definition: ProcessingInstruction. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-processinginstruction-1" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li><li>
      <a href="#ref-for-dfn-processinginstruction-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-processinginstruction-3" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-processinginstruction-4" title="§ 3.2.1.7 XML serializing a ProcessingInstruction node">§ 3.2.1.7 XML serializing a ProcessingInstruction node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-target" aria-label="Links in this document to definition: target">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-target" aria-label="Permalink for definition: target. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-target-1" title="§ 3.2.1.7 XML serializing a ProcessingInstruction node">§ 3.2.1.7 XML serializing a ProcessingInstruction node</a> <a href="#ref-for-dfn-target-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-target-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-range" aria-label="Links in this document to definition: Range">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-range" aria-label="Permalink for definition: Range. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-range-1" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> <a href="#ref-for-dom-range-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text" aria-label="Links in this document to definition: Text">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text" aria-label="Permalink for definition: Text. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-1" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li><li>
      <a href="#ref-for-dfn-text-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li><li>
      <a href="#ref-for-dfn-text-3" title="§ 3.2.1.2 XML serializing a Document node">§ 3.2.1.2 XML serializing a Document node</a> 
    </li><li>
      <a href="#ref-for-dfn-text-4" title="§ 3.2.1.4 XML serializing a Text node">§ 3.2.1.4 XML serializing a Text node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-domexception" aria-label="Links in this document to definition: DOMException">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-domexception" aria-label="Permalink for definition: DOMException. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-domexception-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-domexception-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-domexception-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-domexception-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-domexception-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-domexception-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-domexception-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-domexception-8" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-dfn-domexception-9" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-invalidstateerror" aria-label="Links in this document to definition: InvalidStateError">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-invalidstateerror" aria-label="Permalink for definition: InvalidStateError. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-invalidstateerror-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> 
    </li><li>
      <a href="#ref-for-dfn-invalidstateerror-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-nomodificationallowederror" aria-label="Links in this document to definition: NoModificationAllowedError">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-nomodificationallowederror" aria-label="Permalink for definition: NoModificationAllowedError. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-nomodificationallowederror-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-nomodificationallowederror-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-nomodificationallowederror-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-nomodificationallowederror-4" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-syntaxerror" aria-label="Links in this document to definition: SyntaxError">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-syntaxerror" aria-label="Permalink for definition: SyntaxError. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-syntaxerror-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-syntaxerror-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-syntaxerror-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-xmldocument" aria-label="Links in this document to definition: XMLDocument">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-xmldocument" aria-label="Permalink for definition: XMLDocument. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-attvalue" aria-label="Links in this document to definition: AttValue">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-attvalue" aria-label="Permalink for definition: AttValue. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-attvalue-1" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-char" aria-label="Links in this document to definition: Char">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-char" aria-label="Permalink for definition: Char. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-char-1" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-char-2" title="§ 3.2.1.3 XML serializing a Comment node">§ 3.2.1.3 XML serializing a Comment node</a> 
    </li><li>
      <a href="#ref-for-dfn-char-3" title="§ 3.2.1.4 XML serializing a Text node">§ 3.2.1.4 XML serializing a Text node</a> 
    </li><li>
      <a href="#ref-for-dfn-char-4" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> 
    </li><li>
      <a href="#ref-for-dfn-char-5" title="§ 3.2.1.7 XML serializing a ProcessingInstruction node">§ 3.2.1.7 XML serializing a ProcessingInstruction node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-emptyelemtag" aria-label="Links in this document to definition: EmptyElemTag">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-emptyelemtag" aria-label="Permalink for definition: EmptyElemTag. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-emptyelemtag-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-name" aria-label="Links in this document to definition: Name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-name" aria-label="Permalink for definition: Name. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-name-1" title="§ 3.2.1.1 XML serializing an Element node">§ 3.2.1.1 XML serializing an Element node</a> 
    </li><li>
      <a href="#ref-for-dfn-name-2" title="§ 3.2.1.1.3 Serializing an Element's attributes">§ 3.2.1.1.3 Serializing an Element's attributes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pubidchar" aria-label="Links in this document to definition: PubidChar">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-pubidchar" aria-label="Permalink for definition: PubidChar. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-pubidchar-1" title="§ 3.2.1.6 XML serializing a DocumentType node">§ 3.2.1.6 XML serializing a DocumentType node</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-empty-element-tag" aria-label="Links in this document to definition: empty-element tag">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-empty-element-tag" aria-label="Permalink for definition: empty-element tag. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-empty-element-tag-1" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> <a href="#ref-for-dfn-empty-element-tag-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-typeerror" aria-label="Links in this document to definition: TypeError">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-typeerror" aria-label="Permalink for definition: TypeError. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-typeerror-1" title="§ 2.2 The XMLSerializer interface">§ 2.2 The XMLSerializer interface</a> 
    </li><li>
      <a href="#ref-for-dfn-typeerror-2" title="§ 3.2.1 XML Serialization">§ 3.2.1 XML Serialization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-legacynulltoemptystring" aria-label="Links in this document to definition: [LegacyNullToEmptyString]">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-legacynulltoemptystring" aria-label="Permalink for definition: [LegacyNullToEmptyString]. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-htmlstring" aria-label="Links in this document to definition: HTMLString">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-htmlstring" aria-label="Permalink for definition: HTMLString. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-htmlstring-1" title="§ 2.4 Extensions to the Element interface">§ 2.4 Extensions to the Element interface</a> <a href="#ref-for-dfn-htmlstring-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-htmlstring-3" title="§ 2.5 Extensions to the Range interface">§ 2.5 Extensions to the Range interface</a> 
    </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>